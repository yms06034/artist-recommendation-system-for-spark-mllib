{
  "paragraphs": [
    {
      "text": "%md\n\n# ALS 알고리즘을 사용한 Artist recommendation\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:31:33+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "<div class=\"markdown-body\">\n<h1>ALS 알고리즘을 사용한 Artist recommendation</h1>\n\n</div>"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022208_1248562394",
      "id": "20200817-225420_1196241736",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:383",
      "dateFinished": "2023-04-10T19:31:33+0900",
      "dateStarted": "2023-04-10T19:31:33+0900"
    },
    {
      "title": "",
      "text": "println(spark.version)\nprintln(sc.master)\nprintln(sc.sparkUser)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:05:24+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true,
        "tableHide": false,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "3.2.1\nlocal[*]\nsungjin\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022208_200533220",
      "id": "20200519-104605_1258132758",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "dateStarted": "2023-04-03T16:14:06+0900",
      "dateFinished": "2023-04-03T16:14:06+0900",
      "status": "FINISHED",
      "$$hashKey": "object:384"
    },
    {
      "user": "anonymous",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1681122808406_1610091960",
      "id": "paragraph_1681122808406_1610091960",
      "dateCreated": "2023-04-10T19:33:28+0900",
      "status": "READY",
      "focus": true,
      "$$hashKey": "object:27532",
      "text": "%sh\n\nmkdir -p /yms060-spark/sungjin/spark/data/audio\n\nwget -O /yms060-spark/sungjin/spark/data/audio/profiledata_06-May-2005.tar.gz https://storage.googleapis.com/aas-data-sets/profiledata_06-May-2005.tar.gz\n",
      "dateUpdated": "2023-04-10T19:33:30+0900"
    },
    {
      "title": "",
      "text": "%sh\n\ncd /yms060-spark/sungjin/spark/data/audio\ntar xvfz ./profiledata_06-May-2005.tar.gz\nls -alh\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:32:25+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "profiledata_06-May-2005/\nprofiledata_06-May-2005/artist_data.txt\nprofiledata_06-May-2005/README.txt\nprofiledata_06-May-2005/user_artist_data.txt\nprofiledata_06-May-2005/artist_alias.txt\ntotal 130M\ndrwxr-xr-x 3 sungjin sungjin 4.0K Apr  3 16:22 .\ndrwxr-xr-x 4 sungjin sungjin 4.0K Apr  3 16:21 ..\ndrwxr-xr-x 2 sungjin sungjin 4.0K May 11  2005 profiledata_06-May-2005\n-rw-r--r-- 1 sungjin sungjin 130M Mar 27  2021 profiledata_06-May-2005.tar.gz\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022210_1107890286",
      "id": "20200519-105005_1478735086",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "dateStarted": "2023-04-03T16:22:47+0900",
      "dateFinished": "2023-04-03T16:23:19+0900",
      "status": "FINISHED",
      "$$hashKey": "object:387"
    },
    {
      "title": "",
      "text": "%sh\n\nls -alh /yms060-spark/sungjin/spark/data/audio/profiledata_06-May-2005\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:32:26+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "total 464M\ndrwxr-xr-x 2 sungjin sungjin 4.0K May 11  2005 .\ndrwxr-xr-x 3 sungjin sungjin 4.0K Apr  3 16:22 ..\n-rw-r--r-- 1 sungjin sungjin 1.3K May 11  2005 README.txt\n-rw-r--r-- 1 sungjin sungjin 2.8M May  6  2005 artist_alias.txt\n-rw-r--r-- 1 sungjin sungjin  54M May  6  2005 artist_data.txt\n-rw-r--r-- 1 sungjin sungjin 407M May  5  2005 user_artist_data.txt\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022210_1488513112",
      "id": "20200519-105004_1563817189",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "dateStarted": "2023-04-03T16:23:21+0900",
      "dateFinished": "2023-04-03T16:23:21+0900",
      "status": "FINISHED",
      "$$hashKey": "object:388"
    },
    {
      "text": "%sh\n\n# export HADOOP_USER_NAME=spark\nyms060-spark/sungjin/spark/hadoop3/bin/hdfs dfs -mkdir -p yms060-spark/sungjin/spark/data/audio\nyms060-spark/sungjin/spark/hadoop3/bin/hdfs dfs -put -f yms060-spark/sungjin/spark/data/audio/profiledata_06-May-2005 yms060-spark/sungjin/spark/data/audio\n\nyms060-spark/sungjin/spark/hadoop3/bin/hdfs dfs -ls -h yms060-spark/sungjin/spark/data/audio\nyms060-spark/sungjin/spark/hadoop3/bin/hdfs dfs -ls -h yms060-spark/sungjin/spark/data/audio/profiledata_06-May-2005\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:33:06+0900",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "sh",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sh",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1681122773982_760136948",
      "id": "paragraph_1681122773982_760136948",
      "dateCreated": "2023-04-10T19:32:53+0900",
      "status": "READY",
      "focus": true,
      "$$hashKey": "object:27455",
      "title": "HDFS Upload"
    },
    {
      "title": "User Artist Data Read",
      "text": "val userArtistDS = spark\n    .read\n    .textFile(\"/yms060-spark/sungjin/spark/data/audio/profiledata_06-May-2005/user_artist_data.txt\")  //--spark.read.textFile(path)....\n\nprintln(userArtistDS.count())\nuserArtistDS.printSchema()\nuserArtistDS.show()\nz.show(userArtistDS.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:32:48+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "value": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "multiBarChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "value",
                  "index": 0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": []
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "24296858\nroot\n |-- value: string (nullable = true)\n\n+-------------------+\n|              value|\n+-------------------+\n|       1000002 1 55|\n| 1000002 1000006 33|\n|  1000002 1000007 8|\n|1000002 1000009 144|\n|1000002 1000010 314|\n|  1000002 1000013 8|\n| 1000002 1000014 42|\n| 1000002 1000017 69|\n|1000002 1000024 329|\n|  1000002 1000025 1|\n| 1000002 1000028 17|\n| 1000002 1000031 47|\n| 1000002 1000033 15|\n|  1000002 1000042 1|\n|  1000002 1000045 1|\n|  1000002 1000054 2|\n| 1000002 1000055 25|\n|  1000002 1000056 4|\n|  1000002 1000059 2|\n| 1000002 1000062 71|\n+-------------------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "value\n1000002 1 55\n1000002 1000006 33\n1000002 1000007 8\n1000002 1000009 144\n1000002 1000010 314\n1000002 1000013 8\n1000002 1000014 42\n1000002 1000017 69\n1000002 1000024 329\n1000002 1000025 1\n1000002 1000028 17\n1000002 1000031 47\n1000002 1000033 15\n1000002 1000042 1\n1000002 1000045 1\n1000002 1000054 2\n1000002 1000055 25\n1000002 1000056 4\n1000002 1000059 2\n1000002 1000062 71\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserArtistDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[String]\u001b[0m = [value: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://172.18.119.239:4040/jobs/job?id=10",
              "$$hashKey": "object:27435"
            },
            {
              "jobUrl": "http://172.18.119.239:4040/jobs/job?id=11",
              "$$hashKey": "object:27436"
            },
            {
              "jobUrl": "http://172.18.119.239:4040/jobs/job?id=12",
              "$$hashKey": "object:27437"
            },
            {
              "jobUrl": "http://172.18.119.239:4040/jobs/job?id=13",
              "$$hashKey": "object:27438"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_947711916",
      "id": "20200519-112326_1066031751",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "dateStarted": "2023-04-03T16:26:57+0900",
      "dateFinished": "2023-04-03T16:27:03+0900",
      "status": "FINISHED",
      "$$hashKey": "object:390"
    },
    {
      "title": "User Artist PlayCount Data Read",
      "text": "val userArtistCSVDF = spark\n    .read\n    .option(\"sep\", \" \")\n    .csv(\"hdfs://yms060-spark:9000/sungjin/data/audio/profiledata_06-May-2005/user_artist_data.txt\") \n    .toDF(\"userid\", \"artistid\", \"playcount\")\n\nprintln(userArtistCSVDF.count())\nprintln(userArtistDS.count() - userArtistCSVDF.count())\nuserArtistCSVDF.printSchema()\nuserArtistCSVDF.show()\nz.show(userArtistCSVDF.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:24:36+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "24296858\n0\nroot\n |-- userid: string (nullable = true)\n |-- artistid: string (nullable = true)\n |-- playcount: string (nullable = true)\n\n+-------+--------+---------+\n| userid|artistid|playcount|\n+-------+--------+---------+\n|1000002|       1|       55|\n|1000002| 1000006|       33|\n|1000002| 1000007|        8|\n|1000002| 1000009|      144|\n|1000002| 1000010|      314|\n|1000002| 1000013|        8|\n|1000002| 1000014|       42|\n|1000002| 1000017|       69|\n|1000002| 1000024|      329|\n|1000002| 1000025|        1|\n|1000002| 1000028|       17|\n|1000002| 1000031|       47|\n|1000002| 1000033|       15|\n|1000002| 1000042|        1|\n|1000002| 1000045|        1|\n|1000002| 1000054|        2|\n|1000002| 1000055|       25|\n|1000002| 1000056|        4|\n|1000002| 1000059|        2|\n|1000002| 1000062|       71|\n+-------+--------+---------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n1000002\t1\t55\n1000002\t1000006\t33\n1000002\t1000007\t8\n1000002\t1000009\t144\n1000002\t1000010\t314\n1000002\t1000013\t8\n1000002\t1000014\t42\n1000002\t1000017\t69\n1000002\t1000024\t329\n1000002\t1000025\t1\n1000002\t1000028\t17\n1000002\t1000031\t47\n1000002\t1000033\t15\n1000002\t1000042\t1\n1000002\t1000045\t1\n1000002\t1000054\t2\n1000002\t1000055\t25\n1000002\t1000056\t4\n1000002\t1000059\t2\n1000002\t1000062\t71\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserArtistCSVDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: string, artistid: string ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_143805159",
      "id": "20200519-104849_1473783700",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:391"
    },
    {
      "title": "",
      "text": "userArtistCSVDF.printSchema\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:07:20+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: string (nullable = true)\n |-- artistid: string (nullable = true)\n |-- playcount: string (nullable = true)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_2140325776",
      "id": "paragraph_1622818064869_847484880",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:392"
    },
    {
      "title": "",
      "text": "userArtistCSVDF.describe().show()  //--DataFrame.describe()....\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:07:25+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "summary": "string",
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+------------------+\n|summary|            userid|          artistid|         playcount|\n+-------+------------------+------------------+------------------+\n|  count|          24296858|          24296858|          24296858|\n|   mean|1947573.2653533637|1718704.0937568964| 15.29576248089362|\n| stddev|496000.55518192606| 2539389.092428346|153.91532446979943|\n|    min|           1000002|                 1|                 1|\n|    max|              9875|           9999998|               999|\n+-------+------------------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_878165870",
      "id": "20200519-113634_1063760789",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:393"
    },
    {
      "title": "summary",
      "text": "userArtistCSVDF.summary().show()  //--DataFrame.summary()....\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-03T16:13:42+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+------------------+\n|summary|            userid|          artistid|         playcount|\n+-------+------------------+------------------+------------------+\n|  count|          24296858|          24296858|          24296858|\n|   mean|1947573.2653533637|1718704.0937568964| 15.29576248089362|\n| stddev|496000.55518192594| 2539389.092428346|153.91532446979943|\n|    min|           1000002|                 1|                 1|\n|    25%|         2011966.0|         1000292.0|               1.0|\n|    50%|         2121856.0|         1013151.0|               3.0|\n|    75%|         2280586.0|         1236254.0|               9.0|\n|    max|              9875|           9999998|               999|\n+-------+------------------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_1803913360",
      "id": "20200817-124633_282709826",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:394"
    },
    {
      "title": "",
      "text": "val userArtistCSVDF2 = userArtistCSVDF\n    .selectExpr(\"cast(userid as int)\", \"cast(artistid as int)\", \"cast(playcount as int)\")  //--cast(col as type)....\n\nuserArtistCSVDF2.printSchema\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:08:38+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- playcount: integer (nullable = true)\n\n\u001b[1m\u001b[34muserArtistCSVDF2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_835601168",
      "id": "20200519-120802_1017203104",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:395"
    },
    {
      "title": "",
      "text": "userArtistCSVDF2.summary().show()  //--DataFrame.summary()....\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:08:42+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+------------------+\n|summary|            userid|          artistid|         playcount|\n+-------+------------------+------------------+------------------+\n|  count|          24296858|          24296858|          24296858|\n|   mean|1947573.2653533637|1718704.0937568964| 15.29576248089362|\n| stddev| 496000.5551819261|2539389.0924283466|153.91532446979943|\n|    min|                90|                 1|                 1|\n|    25%|           2011966|           1000292|                 1|\n|    50%|           2121854|           1013151|                 3|\n|    75%|           2280661|           1236254|                 9|\n|    max|           2443548|          10794401|            439771|\n+-------+------------------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_703384424",
      "id": "20200519-120355_1137095367",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:396"
    },
    {
      "title": "",
      "text": "userArtistCSVDF2\n    .where(\"playcount = 439771\")\n    .show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:08:48+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------+---------+\n| userid|artistid|playcount|\n+-------+--------+---------+\n|2064012|    4468|   439771|\n+-------+--------+---------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_1095402856",
      "id": "20200519-121725_455267807",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:397"
    },
    {
      "title": "",
      "text": "// 음악 한곡당 4분이라 가정\n4 * 439771 / 60F/ 24L/ 365F\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:33:57+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres10\u001b[0m: \u001b[1m\u001b[32mFloat\u001b[0m = 3.346811\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_1845018280",
      "id": "20200519-121901_2083895128",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:398"
    },
    {
      "title": "",
      "text": "6 * 30 * 24 * 60 / 4\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:09:35+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres11\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 64800\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_2119006696",
      "id": "20200523-005633_1577370194",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:399"
    },
    {
      "title": "",
      "text": "userArtistCSVDF2\n    .where($\"playcount\" > 64800)\n    .withColumn(\"playyear\", round('playcount * 4 / 60F / 24L / 365F, 3))\n    .orderBy('playcount.desc)\n    .show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:09:40+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------+---------+--------+\n| userid|artistid|playcount|playyear|\n+-------+--------+---------+--------+\n|2064012|    4468|   439771|   3.347|\n|1059637| 1002095|   433060|   3.296|\n|1059637| 1026440|   155895|   1.186|\n|2069889| 1002095|   101076|   0.769|\n|2020513| 1007801|    88908|   0.677|\n|1073421| 1004440|    67548|   0.514|\n+-------+--------+---------+--------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022222_1303601324",
      "id": "20200519-113637_170204163",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:400"
    },
    {
      "title": "",
      "text": "val userArtistCSVDF3 = userArtistCSVDF2\n    .filter(\"playcount <= 64800\")\n\nuserArtistCSVDF3.persist(org.apache.spark.storage.StorageLevel.MEMORY_ONLY)\nprintln(userArtistCSVDF3.count())\nuserArtistCSVDF3.printSchema()\nuserArtistCSVDF3.show()\nz.show(userArtistCSVDF3.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:09:43+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true,
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "24296852\nroot\n |-- userid: integer (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- playcount: integer (nullable = true)\n\n+-------+--------+---------+\n| userid|artistid|playcount|\n+-------+--------+---------+\n|1000002|       1|       55|\n|1000002| 1000006|       33|\n|1000002| 1000007|        8|\n|1000002| 1000009|      144|\n|1000002| 1000010|      314|\n|1000002| 1000013|        8|\n|1000002| 1000014|       42|\n|1000002| 1000017|       69|\n|1000002| 1000024|      329|\n|1000002| 1000025|        1|\n|1000002| 1000028|       17|\n|1000002| 1000031|       47|\n|1000002| 1000033|       15|\n|1000002| 1000042|        1|\n|1000002| 1000045|        1|\n|1000002| 1000054|        2|\n|1000002| 1000055|       25|\n|1000002| 1000056|        4|\n|1000002| 1000059|        2|\n|1000002| 1000062|       71|\n+-------+--------+---------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n1000002\t1\t55\n1000002\t1000006\t33\n1000002\t1000007\t8\n1000002\t1000009\t144\n1000002\t1000010\t314\n1000002\t1000013\t8\n1000002\t1000014\t42\n1000002\t1000017\t69\n1000002\t1000024\t329\n1000002\t1000025\t1\n1000002\t1000028\t17\n1000002\t1000031\t47\n1000002\t1000033\t15\n1000002\t1000042\t1\n1000002\t1000045\t1\n1000002\t1000054\t2\n1000002\t1000055\t25\n1000002\t1000056\t4\n1000002\t1000059\t2\n1000002\t1000062\t71\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserArtistCSVDF3\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_1215528025",
      "id": "20200523-005937_1543199428",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:401"
    },
    {
      "title": "",
      "text": "println(userArtistDS.count() - userArtistCSVDF3.count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:09:48+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "6\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_225631197",
      "id": "20200818-063959_1200463835",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:402"
    },
    {
      "title": "",
      "text": "val artistDS = spark\n    .read\n    .textFile(\"hdfs://yms060-spark:9000/sungjin/data/audio/profiledata_06-May-2005/artist_data.txt\")\n\nprintln(artistDS.count())\nartistDS.printSchema()\nartistDS.show(truncate=false)\nz.show(artistDS.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:25:27+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "value": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1848707\nroot\n |-- value: string (nullable = true)\n\n+--------------------------------------------------+\n|value                                             |\n+--------------------------------------------------+\n|1134999\\t06Crazy Life                             |\n|6821360\\tPang Nakarin                             |\n|10113088\\tTerfel, Bartoli- Mozart: Don            |\n|10151459\\tThe Flaming Sidebur                     |\n|6826647\\tBodenstandig 3000                        |\n|10186265\\tJota Quest e Ivete Sangalo              |\n|6828986\\tToto_XX (1977                            |\n|10236364\\tU.S Bombs -                             |\n|1135000\\tartist formaly know as Mat               |\n|10299728\\tKassierer - Musik für beide Ohren       |\n|10299744\\tRahzel, RZA                             |\n|6864258\\tJon Richardson                           |\n|6878791\\tYoung Fresh Fellowslows & the Minus 5    |\n|10299751\\tKi-ya-Kiss                              |\n|6909716\\tUnderminded - The Task Of Modern Educator|\n|10435121\\tKox-Box                                 |\n|6918061\\talexisonfire [wo!]                       |\n|1135001\\tdj salinger                              |\n|6940391\\tThe B52's - Channel Z                    |\n|10475396\\t44 Hoes                                 |\n+--------------------------------------------------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "value\n1134999 06Crazy Life\n6821360 Pang Nakarin\n10113088 Terfel, Bartoli- Mozart: Don\n10151459 The Flaming Sidebur\n6826647 Bodenstandig 3000\n10186265 Jota Quest e Ivete Sangalo\n6828986 Toto_XX (1977\n10236364 U.S Bombs -\n1135000 artist formaly know as Mat\n10299728 Kassierer - Musik für beide Ohren\n10299744 Rahzel, RZA\n6864258 Jon Richardson\n6878791 Young Fresh Fellowslows & the Minus 5\n10299751 Ki-ya-Kiss\n6909716 Underminded - The Task Of Modern Educator\n10435121 Kox-Box\n6918061 alexisonfire [wo!]\n1135001 dj salinger\n6940391 The B52's - Channel Z\n10475396 44 Hoes\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34martistDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[String]\u001b[0m = [value: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_214288103",
      "id": "20200519-121641_444714927",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:404"
    },
    {
      "title": "",
      "text": "val artistDF = spark\n    .read\n    .option(\"sep\", \"\\t\")\n    .option(\"inferSchema\", true)  //--inferSchema => true....\n    .csv(\"hdfs://yms060-spark:9000/sungjin/data/audio/profiledata_06-May-2005/artist_data.txt\")\n    .toDF(\"artistid\", \"artistname\")\n    \nprintln(artistDF.count())\nprintln(artistDS.count() - artistDF.count())\nartistDF.printSchema()\nartistDF.show(false)\nz.show(artistDF.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:25:53+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "artistid": "string",
                      "artistname": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1848671\n36\nroot\n |-- artistid: string (nullable = true)\n |-- artistname: string (nullable = true)\n\n+--------+-----------------------------------------+\n|artistid|artistname                               |\n+--------+-----------------------------------------+\n|1134999 |06Crazy Life                             |\n|6821360 |Pang Nakarin                             |\n|10113088|Terfel, Bartoli- Mozart: Don             |\n|10151459|The Flaming Sidebur                      |\n|6826647 |Bodenstandig 3000                        |\n|10186265|Jota Quest e Ivete Sangalo               |\n|6828986 |Toto_XX (1977                            |\n|10236364|U.S Bombs -                              |\n|1135000 |artist formaly know as Mat               |\n|10299728|Kassierer - Musik für beide Ohren        |\n|10299744|Rahzel, RZA                              |\n|6864258 |Jon Richardson                           |\n|6878791 |Young Fresh Fellowslows & the Minus 5    |\n|10299751|Ki-ya-Kiss                               |\n|6909716 |Underminded - The Task Of Modern Educator|\n|10435121|Kox-Box                                  |\n|6918061 |alexisonfire [wo!]                       |\n|1135001 |dj salinger                              |\n|6940391 |The B52's - Channel Z                    |\n|10475396|44 Hoes                                  |\n+--------+-----------------------------------------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "artistid\tartistname\n1134999\t06Crazy Life\n6821360\tPang Nakarin\n10113088\tTerfel, Bartoli- Mozart: Don\n10151459\tThe Flaming Sidebur\n6826647\tBodenstandig 3000\n10186265\tJota Quest e Ivete Sangalo\n6828986\tToto_XX (1977\n10236364\tU.S Bombs -\n1135000\tartist formaly know as Mat\n10299728\tKassierer - Musik für beide Ohren\n10299744\tRahzel, RZA\n6864258\tJon Richardson\n6878791\tYoung Fresh Fellowslows & the Minus 5\n10299751\tKi-ya-Kiss\n6909716\tUnderminded - The Task Of Modern Educator\n10435121\tKox-Box\n6918061\talexisonfire [wo!]\n1135001\tdj salinger\n6940391\tThe B52's - Channel Z\n10475396\t44 Hoes\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34martistDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [artistid: string, artistname: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_795648014",
      "id": "20200519-122342_159229133",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:405"
    },
    {
      "title": "",
      "text": "artistDF.summary().show()  //--DataFrame.summary()....\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:22+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------------------+---------------+\n|summary|            artistid|     artistname|\n+-------+--------------------+---------------+\n|  count|             1848669|        1848296|\n|   mean|   7028265.171776369|            NaN|\n| stddev|   3753055.545402786|            NaN|\n|    min|\u0002@\u0002\u0014\u0002;\u0002\u0018\u00026\u0002\u001d\u00022\u0002 \u0002...|              \u0001|\n|    25%|           2124296.0|           33.0|\n|    50%|           7009217.0|          304.0|\n|    75%|         1.0331483E7|         1988.0|\n|    max|               ﾐｯﾔ｢-|￿￿￿￿￿￿￿￿￿￿￿￿くȁ|\n+-------+--------------------+---------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_1615543348",
      "id": "20200519-122342_562896924",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:406"
    },
    {
      "title": "",
      "text": "artistDF.filter(row => {\n    val artistid = row.getString(0)\n    val artistname = row.getString(1)\n    try {\n        artistid.toInt\n        false\n    } catch {\n        case e:Exception => true\n    }\n    \n}).show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:34:08+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------------------------------------------------------------------+----------------------------------------------------------------------------------------+\n|artistid                                                                |artistname                                                                              |\n+------------------------------------------------------------------------+----------------------------------------------------------------------------------------+\n|Aya Hisakawa                                                            |null                                                                                    |\n|Aya Sakaguchi                                                           |null                                                                                    |\n|Miki Itou                                                               |null                                                                                    |\n|Youko Sawami                                                            |null                                                                                    |\n|Taeko Kawada                                                            |null                                                                                    |\n|}4                                                                      |null                                                                                    |\n|0sH,\u000fｮ,80ｮP,ｰ蔑                                                        |null                                                                                    |\n|Helsinki Philharmonic Orchestra - Leif Segerstam,   Kari Jussila - Organ|null                                                                                    |\n|Helsinki Philharmonic Orchestra - Leif Segerstam,   Kari Jussila - Organ|null                                                                                    |\n|È2—                                                                     |null                                                                                    |\n|\\as                                                                     |null                                                                                    |\n|\\aú                                                                     |F\u0005Ù\\b\u0001â\u0005\u0012ýM\u0001qøöû)ô\u0013÷Bñ÷óÕðópò;ôêóÍô®õ\u0019÷7úû[ÿ>ÿ\u00014\u0001à\u0002I\u0003\u0005£\u0005\u0012\\a\u0006 \u0005y\u0004Æ\u0002                |\n|#!|\u0006ÒÞd¥ ÖÃå\u0010º¥\u00198¨É¸Á¹ J2V÷\u001c,´-4 Ú.5¼·æÝjÒW²¾ªö³NÛ¦Ñ\u000f#òcÿ  |null                                                                                    |\n|XÈ ÕBCpæ¡À\u0012\"øÂ¥#f c`L\u0006\u0011°J\u0010\u00015ZA\u001bdMíz                              |\\bH\u0015w±TR*¾HA,Âb\\f\u0018ì\u0014\u0012e ´2`\u001c½@\\v¬3b4iAh5\u0012\\fJand\"0A\u0004\u0011Ú\\v¨Ñ`É\u0013!\\vÈÔ\\bb*\u0005B©A\u0004U|\n|\u0016v\u0019»ß6¨¬Ý¦e³'é                                                         |null                                                                                    |\n|Zt                                                                      |null                                                                                    |\n|Bÿÿ                                                                     |null                                                                                    |\n|B\u0016!\u0004@and!\u0004@@Q\u0004@F!\u0004@V!\u0004@f!\u0004@v!\u0004@ÿ!\u0004@ÿ!\u0004@ÿ!\u0004@ÿ!\u0004@ÿ!\u0004@ÿ!\u0004@ÿx\u000eB ([XRM]      |null                                                                                    |\n|ùÓ\u000f9ù\u001b\u0011kùc\u0011út\u0010ðû§\u000fpüò\u000fïüÓ\u0010rþ\u0012\u0012@                                       |null                                                                                    |\n|3AW                                                                     |null                                                                                    |\n+------------------------------------------------------------------------+----------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_851166539",
      "id": "20200519-122340_1688834626",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:407"
    },
    {
      "title": "",
      "text": "val artistFinal = artistDF.filter(row => {\n    val artistid = row.getString(0)\n    val artistname = row.getString(1)\n    try {\n        artistid.toInt\n        true\n    } catch {\n        case e:Exception => false\n    }\n})\n.where(\"artistid is not null\")\n.where(\"artistname is not null\")\n.withColumn(\"artistid\", expr(\"cast(artistid as int)\"))\n\nprintln(artistFinal.count())\nartistFinal.printSchema()\nartistFinal.show(false)\nz.show(artistFinal.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:34:19+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "artistid": "string",
                      "artistname": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "1848280\nroot\n |-- artistid: integer (nullable = true)\n |-- artistname: string (nullable = true)\n\n+--------+-----------------------------------------+\n|artistid|artistname                               |\n+--------+-----------------------------------------+\n|1134999 |06Crazy Life                             |\n|6821360 |Pang Nakarin                             |\n|10113088|Terfel, Bartoli- Mozart: Don             |\n|10151459|The Flaming Sidebur                      |\n|6826647 |Bodenstandig 3000                        |\n|10186265|Jota Quest e Ivete Sangalo               |\n|6828986 |Toto_XX (1977                            |\n|10236364|U.S Bombs -                              |\n|1135000 |artist formaly know as Mat               |\n|10299728|Kassierer - Musik für beide Ohren        |\n|10299744|Rahzel, RZA                              |\n|6864258 |Jon Richardson                           |\n|6878791 |Young Fresh Fellowslows & the Minus 5    |\n|10299751|Ki-ya-Kiss                               |\n|6909716 |Underminded - The Task Of Modern Educator|\n|10435121|Kox-Box                                  |\n|6918061 |alexisonfire [wo!]                       |\n|1135001 |dj salinger                              |\n|6940391 |The B52's - Channel Z                    |\n|10475396|44 Hoes                                  |\n+--------+-----------------------------------------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "artistid\tartistname\n1134999\t06Crazy Life\n6821360\tPang Nakarin\n10113088\tTerfel, Bartoli- Mozart: Don\n10151459\tThe Flaming Sidebur\n6826647\tBodenstandig 3000\n10186265\tJota Quest e Ivete Sangalo\n6828986\tToto_XX (1977\n10236364\tU.S Bombs -\n1135000\tartist formaly know as Mat\n10299728\tKassierer - Musik für beide Ohren\n10299744\tRahzel, RZA\n6864258\tJon Richardson\n6878791\tYoung Fresh Fellowslows & the Minus 5\n10299751\tKi-ya-Kiss\n6909716\tUnderminded - The Task Of Modern Educator\n10435121\tKox-Box\n6918061\talexisonfire [wo!]\n1135001\tdj salinger\n6940391\tThe B52's - Channel Z\n10475396\t44 Hoes\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34martistFinal\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [artistid: int, artistname: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_1123841033",
      "id": "20200519-124410_1263611170",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:408"
    },
    {
      "title": "",
      "text": "artistFinal.summary().show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:33+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+---------------+\n|summary|          artistid|     artistname|\n+-------+------------------+---------------+\n|  count|           1848280|        1848280|\n|   mean| 7028268.271536239|            NaN|\n| stddev|3753054.1947157457|            NaN|\n|    min|                 1|              \u0001|\n|    25%|           2124311|           33.0|\n|    50%|           7009217|          304.0|\n|    75%|          10331483|         1988.0|\n|    max|          10794305|￿￿￿￿￿￿￿￿￿￿￿￿くȁ|\n+-------+------------------+---------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_132282373",
      "id": "20200519-122338_815840473",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:409"
    },
    {
      "title": "",
      "text": "artistFinal.where(\"artistname is null\").show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:36+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+----------+\n|artistid|artistname|\n+--------+----------+\n+--------+----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_1178224364",
      "id": "20200523-004212_188172716",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:410"
    },
    {
      "title": "",
      "text": "artistFinal.where(\"artistname in ('33', '304', '1988')\").show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:38+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+----------+\n|artistid|artistname|\n+--------+----------+\n| 1335772|        33|\n| 1344623|      1988|\n| 2032179|       304|\n+--------+----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_809964712",
      "id": "paragraph_1608532239464_751189865",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:411"
    },
    {
      "title": "",
      "text": "artistDS.where(\"value like '1335772%' or value like '1344623%' or value like '2032179%'\").show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:41+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------+\n|value        |\n+-------------+\n|1335772\\t33  |\n|1344623\\t1988|\n|2032179\\t304 |\n+-------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_1639009581",
      "id": "paragraph_1608532547696_197486751",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:412"
    },
    {
      "title": "이상한 이름 발견",
      "text": "artistFinal.where(\"artistname in ('\u0001', '￿￿￿￿￿￿￿￿￿￿￿￿くȁ')\").show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:47+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+---------------+\n|artistid|     artistname|\n+--------+---------------+\n| 1165062|              \u0001|\n|10495051|￿￿￿￿￿￿￿￿￿￿￿￿くȁ|\n+--------+---------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022223_48531949",
      "id": "20200818-062925_1934114139",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:413"
    },
    {
      "title": "",
      "text": "artistDS.where(\"value like '1165062%' or value like '10495051%'\").show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:50+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------------+\n|value                    |\n+-------------------------+\n|1165062\\t\u0001               |\n|10495051\\t￿￿￿￿￿￿￿￿￿￿￿￿くȁ|\n+-------------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1976910980",
      "id": "20200818-063233_2000252041",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:414"
    },
    {
      "title": "",
      "text": "println(artistDS.count() - artistFinal.count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:10:53+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "427\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1406647016",
      "id": "20200519-122336_2101558402",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:415"
    },
    {
      "title": "",
      "text": "val artistAliasDS = spark\n    .read\n    .textFile(\"hdfs://yms060-spark:9000/sungjin/data/audio/profiledata_06-May-2005/artist_alias.txt\")\n    \nprintln(artistAliasDS.count())\nartistAliasDS.printSchema()\nartistAliasDS.show()\nz.show(artistAliasDS.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:26:00+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "value": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "193027\nroot\n |-- value: string (nullable = true)\n\n+-----------------+\n|            value|\n+-----------------+\n| 1092764\\t1000311|\n| 1095122\\t1000557|\n| 6708070\\t1007267|\n|10088054\\t1042317|\n| 1195917\\t1042317|\n| 1112006\\t1000557|\n| 1187350\\t1294511|\n| 1116694\\t1327092|\n| 6793225\\t1042317|\n| 1079959\\t1000557|\n| 6789612\\t1000591|\n| 1262241\\t1000591|\n| 6791455\\t1000591|\n| 6694867\\t1000591|\n|10141141\\t1113738|\n| 1295140\\t1000591|\n| 1027859\\t1252408|\n| 2127019\\t1000591|\n| 2153974\\t1000591|\n| 1232342\\t1000591|\n+-----------------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "value\n1092764 1000311\n1095122 1000557\n6708070 1007267\n10088054 1042317\n1195917 1042317\n1112006 1000557\n1187350 1294511\n1116694 1327092\n6793225 1042317\n1079959 1000557\n6789612 1000591\n1262241 1000591\n6791455 1000591\n6694867 1000591\n10141141 1113738\n1295140 1000591\n1027859 1252408\n2127019 1000591\n2153974 1000591\n1232342 1000591\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34martistAliasDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[String]\u001b[0m = [value: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_2109334664",
      "id": "20200519-125924_1498275709",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:417"
    },
    {
      "title": "",
      "text": "val artistAliasDF = spark\n    .read\n    .option(\"sep\", \"\\t\")\n    .option(\"inferSchema\", true) \n    .csv(\"hdfs://yms060-spark:9000/sungjin/data/audio/profiledata_06-May-2005/artist_alias.txt\")\n    .toDF(\"badid\", \"goodid\")\n    \nprintln(artistAliasDF.count())\nartistAliasDF.printSchema()\nartistAliasDF.show()\nz.show(artistAliasDF.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:26:09+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "badid": "string",
                      "goodid": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "193027\nroot\n |-- badid: integer (nullable = true)\n |-- goodid: integer (nullable = true)\n\n+--------+-------+\n|   badid| goodid|\n+--------+-------+\n| 1092764|1000311|\n| 1095122|1000557|\n| 6708070|1007267|\n|10088054|1042317|\n| 1195917|1042317|\n| 1112006|1000557|\n| 1187350|1294511|\n| 1116694|1327092|\n| 6793225|1042317|\n| 1079959|1000557|\n| 6789612|1000591|\n| 1262241|1000591|\n| 6791455|1000591|\n| 6694867|1000591|\n|10141141|1113738|\n| 1295140|1000591|\n| 1027859|1252408|\n| 2127019|1000591|\n| 2153974|1000591|\n| 1232342|1000591|\n+--------+-------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "badid\tgoodid\n1092764\t1000311\n1095122\t1000557\n6708070\t1007267\n10088054\t1042317\n1195917\t1042317\n1112006\t1000557\n1187350\t1294511\n1116694\t1327092\n6793225\t1042317\n1079959\t1000557\n6789612\t1000591\n1262241\t1000591\n6791455\t1000591\n6694867\t1000591\n10141141\t1113738\n1295140\t1000591\n1027859\t1252408\n2127019\t1000591\n2153974\t1000591\n1232342\t1000591\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34martistAliasDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [badid: int, goodid: int]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1268967547",
      "id": "20200519-130215_2111760566",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:418"
    },
    {
      "title": "",
      "text": "artistAliasDF.summary().show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:14+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+\n|summary|             badid|            goodid|\n+-------+------------------+------------------+\n|  count|            190892|            193027|\n|   mean|4987567.2059489135| 1160313.683329275|\n| stddev| 3626984.543545069|1592131.7150057629|\n|    min|                12|                 1|\n|    25%|           1261956|              5705|\n|    50%|           6625839|           1006160|\n|    75%|           6999743|           1139616|\n|    max|          10788933|          10712806|\n+-------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_596968332",
      "id": "20200519-130213_2029350658",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:419"
    },
    {
      "title": "null 값 확인",
      "text": "artistAliasDF.where(\"badid is null\").show(false)\nartistAliasDF.filter(\"goodid is null\").show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:25+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-------+\n|badid|goodid |\n+-----+-------+\n|null |2002877|\n|null |6826174|\n|null |1259224|\n|null |1207061|\n|null |6851474|\n|null |2011821|\n|null |1281469|\n|null |6621504|\n|null |1349423|\n|null |6686086|\n|null |6738682|\n|null |1339242|\n|null |6728332|\n|null |1246524|\n|null |2078928|\n|null |2163796|\n|null |1224964|\n|null |1091070|\n|null |6683418|\n|null |1095312|\n+-----+-------+\nonly showing top 20 rows\n\n+-----+------+\n|badid|goodid|\n+-----+------+\n+-----+------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1509927051",
      "id": "20200519-130210_312875865",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:420"
    },
    {
      "title": "null 제거",
      "text": "val artistAliasFinal = artistAliasDF\n    .filter(\"badid is not null\")\n    .filter(\"goodid is not null\")\n\nprintln(artistAliasFinal.count())\nartistAliasFinal.printSchema()\nartistAliasFinal.show()\nz.show(artistAliasFinal.limit(20))\n\nartistAliasFinal.createOrReplaceTempView(\"artistAliasFinal\")\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:30+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "badid": "string",
                      "goodid": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "190892\nroot\n |-- badid: integer (nullable = true)\n |-- goodid: integer (nullable = true)\n\n+--------+-------+\n|   badid| goodid|\n+--------+-------+\n| 1092764|1000311|\n| 1095122|1000557|\n| 6708070|1007267|\n|10088054|1042317|\n| 1195917|1042317|\n| 1112006|1000557|\n| 1187350|1294511|\n| 1116694|1327092|\n| 6793225|1042317|\n| 1079959|1000557|\n| 6789612|1000591|\n| 1262241|1000591|\n| 6791455|1000591|\n| 6694867|1000591|\n|10141141|1113738|\n| 1295140|1000591|\n| 1027859|1252408|\n| 2127019|1000591|\n| 2153974|1000591|\n| 1232342|1000591|\n+--------+-------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "badid\tgoodid\n1092764\t1000311\n1095122\t1000557\n6708070\t1007267\n10088054\t1042317\n1195917\t1042317\n1112006\t1000557\n1187350\t1294511\n1116694\t1327092\n6793225\t1042317\n1079959\t1000557\n6789612\t1000591\n1262241\t1000591\n6791455\t1000591\n6694867\t1000591\n10141141\t1113738\n1295140\t1000591\n1027859\t1252408\n2127019\t1000591\n2153974\t1000591\n1232342\t1000591\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34martistAliasFinal\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [badid: int, goodid: int]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1800427242",
      "id": "20200519-130207_783358586",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:421"
    },
    {
      "title": "",
      "text": "artistAliasFinal.summary().show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:35+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------------+------------------+\n|summary|badid             |goodid            |\n+-------+------------------+------------------+\n|count  |190892            |190892            |\n|mean   |4987567.2059489135|1129072.1158141776|\n|stddev |3626984.543545069 |1534740.7568274764|\n|min    |12                |1                 |\n|25%    |1261956           |5661              |\n|50%    |6625839           |1005975           |\n|75%    |6999743           |1117105           |\n|max    |10788933          |10712806          |\n+-------+------------------+------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1141917520",
      "id": "20200519-131300_1214615547",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:422"
    },
    {
      "title": "",
      "text": "println(artistAliasDS.count() - artistAliasFinal.count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:38+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "2135\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1093490861",
      "id": "20200519-131316_5329034",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:423"
    },
    {
      "title": "",
      "text": "userArtistCSVDF3.printSchema()\nartistAliasFinal.printSchema()\n\nuserArtistCSVDF3.createOrReplaceTempView(\"userArtistCSVDF3\")\nartistAliasFinal.createOrReplaceTempView(\"artistAliasFinal\")\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:44+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- playcount: integer (nullable = true)\n\nroot\n |-- badid: integer (nullable = true)\n |-- goodid: integer (nullable = true)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1702809104",
      "id": "20200523-005422_1257109822",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:425"
    },
    {
      "title": "",
      "text": "%sql\n\nselect\n    distinct(badid)\nfrom \n    artistAliasFinal\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:11:46+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "badid": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "badid\n1295140\n1314067\n6965596\n1286983\n6860995\n1260105\n6641451\n6686250\n10003098\n2159136\n2061284\n1156120\n10087946\n2038737\n6625218\n6960522\n2172400\n6996751\n10046597\n10233445\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_1060334208",
      "id": "20200523-013841_2015607067",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:426"
    },
    {
      "title": "",
      "text": "//artistAliasFinal.select(distinct($\"badid\")).show()  \nartistAliasFinal.select(countDistinct($\"badid\")).show()  \n\nspark.sql(\"select distinct(badid) from artistAliasFinal\").show()  \nspark.sql(\"select count(distinct(badid)) from artistAliasFinal\").show() \n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:34:45+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------------------+\n|count(DISTINCT badid)|\n+---------------------+\n|               190892|\n+---------------------+\n\n+---------------------+\n|count(DISTINCT badid)|\n+---------------------+\n|               190892|\n+---------------------+\n\n+--------+\n|   badid|\n+--------+\n| 1295140|\n| 1314067|\n| 6965596|\n| 1286983|\n| 6860995|\n| 1260105|\n| 6641451|\n| 6686250|\n|10003098|\n| 2159136|\n| 2061284|\n| 1156120|\n|10087946|\n| 2038737|\n| 6625218|\n| 6960522|\n| 2172400|\n| 6996751|\n|10046597|\n|10233445|\n+--------+\nonly showing top 20 rows\n\n+---------------------+\n|count(DISTINCT badid)|\n+---------------------+\n|               190892|\n+---------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022224_199502",
      "id": "20200523-014001_775863416",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:427"
    },
    {
      "title": "",
      "text": "println(artistAliasFinal.count())\nartistAliasFinal.select(expr(\"count(distinct(badid))\")).show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:12:26+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "190892\n+---------------------+\n|count(DISTINCT badid)|\n+---------------------+\n|               190892|\n+---------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_158775268",
      "id": "20200523-011408_65652645",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:428"
    },
    {
      "title": "\\",
      "text": "%sql\n\nselect \n    *\nfrom\n    userArtistCSVDF3 ua\n    left outer join\n    artistAliasFinal aa\n    on \n    ua.artistid = aa.badid\nwhere\n    true\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:34:52+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string",
                      "badid": "string",
                      "goodid": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\tbadid\tgoodid\n1000002\t1\t55\tnull\tnull\n1000002\t1000006\t33\tnull\tnull\n1000002\t1000007\t8\tnull\tnull\n1000002\t1000009\t144\tnull\tnull\n1000002\t1000010\t314\tnull\tnull\n1000002\t1000013\t8\tnull\tnull\n1000002\t1000014\t42\tnull\tnull\n1000002\t1000017\t69\tnull\tnull\n1000002\t1000024\t329\tnull\tnull\n1000002\t1000025\t1\tnull\tnull\n1000002\t1000028\t17\tnull\tnull\n1000002\t1000031\t47\tnull\tnull\n1000002\t1000033\t15\tnull\tnull\n1000002\t1000042\t1\tnull\tnull\n1000002\t1000045\t1\tnull\tnull\n1000002\t1000054\t2\tnull\tnull\n1000002\t1000055\t25\tnull\tnull\n1000002\t1000056\t4\tnull\tnull\n1000002\t1000059\t2\tnull\tnull\n1000002\t1000062\t71\tnull\tnull\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1167718908",
      "id": "20200523-010440_251109865",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:429"
    },
    {
      "title": "Bad id join good id",
      "text": "%sql\n\nselect \n    ua.*,\n    aa.*,\n    case\n        when aa.badid is not null then aa.goodid\n        else ua.artistid\n    end\n    as artistid2\nfrom\n    userArtistCSVDF3 ua\n    left outer join\n    artistAliasFinal aa\n    on \n    ua.artistid = aa.badid\nwhere\n    true\n--and aa.badid is not null\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:12:54+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string",
                      "badid": "string",
                      "goodid": "string",
                      "artistid2": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\tbadid\tgoodid\tartistid2\n1000002\t1\t55\tnull\tnull\t1\n1000002\t1000006\t33\tnull\tnull\t1000006\n1000002\t1000007\t8\tnull\tnull\t1000007\n1000002\t1000009\t144\tnull\tnull\t1000009\n1000002\t1000010\t314\tnull\tnull\t1000010\n1000002\t1000013\t8\tnull\tnull\t1000013\n1000002\t1000014\t42\tnull\tnull\t1000014\n1000002\t1000017\t69\tnull\tnull\t1000017\n1000002\t1000024\t329\tnull\tnull\t1000024\n1000002\t1000025\t1\tnull\tnull\t1000025\n1000002\t1000028\t17\tnull\tnull\t1000028\n1000002\t1000031\t47\tnull\tnull\t1000031\n1000002\t1000033\t15\tnull\tnull\t1000033\n1000002\t1000042\t1\tnull\tnull\t1000042\n1000002\t1000045\t1\tnull\tnull\t1000045\n1000002\t1000054\t2\tnull\tnull\t1000054\n1000002\t1000055\t25\tnull\tnull\t1000055\n1000002\t1000056\t4\tnull\tnull\t1000056\n1000002\t1000059\t2\tnull\tnull\t1000059\n1000002\t1000062\t71\tnull\tnull\t1000062\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1073731966",
      "id": "20200523-012325_716785265",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:430"
    },
    {
      "title": "Bad id join good id test",
      "text": "%sql\n\nselect \n    ua.userid,\n    case\n        when aa.badid is not null then aa.goodid\n        else ua.artistid\n    end\n    as artistid,\n    ua.playcount\nfrom\n    userArtistCSVDF3 ua\n    left outer join\n    artistAliasFinal aa\n    on \n    ua.artistid = aa.badid\nwhere\n    true\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:35:00+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n1000002\t1\t55\n1000002\t1000006\t33\n1000002\t1000007\t8\n1000002\t1000009\t144\n1000002\t1000010\t314\n1000002\t1000013\t8\n1000002\t1000014\t42\n1000002\t1000017\t69\n1000002\t1000024\t329\n1000002\t1000025\t1\n1000002\t1000028\t17\n1000002\t1000031\t47\n1000002\t1000033\t15\n1000002\t1000042\t1\n1000002\t1000045\t1\n1000002\t1000054\t2\n1000002\t1000055\t25\n1000002\t1000056\t4\n1000002\t1000059\t2\n1000002\t1000062\t71\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1771058205",
      "id": "20200523-012907_565028612",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:431"
    },
    {
      "title": "최종 변경",
      "text": "val userArtistCSVDF4 = spark.sql(\"\"\"\n\nselect \n    ua.userid,\n    case\n        when aa.badid is not null then aa.goodid\n        else ua.artistid\n    end\n    as artistid,\n    ua.playcount\nfrom\n    userArtistCSVDF3 ua\n    left outer join\n    artistAliasFinal aa\n    on \n    ua.artistid = aa.badid\nwhere\n    true\n--and aa.badid is not null\n\n\"\"\")\n\nprintln(userArtistCSVDF4.count())\nuserArtistCSVDF4.printSchema()\nuserArtistCSVDF4.show()\nz.show(userArtistCSVDF4.limit(20))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:13:11+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "24296852\nroot\n |-- userid: integer (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- playcount: integer (nullable = true)\n\n+-------+--------+---------+\n| userid|artistid|playcount|\n+-------+--------+---------+\n|1000002|       1|       55|\n|1000002| 1000006|       33|\n|1000002| 1000007|        8|\n|1000002| 1000009|      144|\n|1000002| 1000010|      314|\n|1000002| 1000013|        8|\n|1000002| 1000014|       42|\n|1000002| 1000017|       69|\n|1000002| 1000024|      329|\n|1000002| 1000025|        1|\n|1000002| 1000028|       17|\n|1000002| 1000031|       47|\n|1000002| 1000033|       15|\n|1000002| 1000042|        1|\n|1000002| 1000045|        1|\n|1000002| 1000054|        2|\n|1000002| 1000055|       25|\n|1000002| 1000056|        4|\n|1000002| 1000059|        2|\n|1000002| 1000062|       71|\n+-------+--------+---------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n1000002\t1\t55\n1000002\t1000006\t33\n1000002\t1000007\t8\n1000002\t1000009\t144\n1000002\t1000010\t314\n1000002\t1000013\t8\n1000002\t1000014\t42\n1000002\t1000017\t69\n1000002\t1000024\t329\n1000002\t1000025\t1\n1000002\t1000028\t17\n1000002\t1000031\t47\n1000002\t1000033\t15\n1000002\t1000042\t1\n1000002\t1000045\t1\n1000002\t1000054\t2\n1000002\t1000055\t25\n1000002\t1000056\t4\n1000002\t1000059\t2\n1000002\t1000062\t71\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserArtistCSVDF4\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1196068752",
      "id": "20200523-015402_1745263578",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:432"
    },
    {
      "title": "",
      "text": "println(userArtistCSVDF3.count() - userArtistFinal.count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:13:22+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "0\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1607481711",
      "id": "20200818-065235_1727884621",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:434"
    },
    {
      "title": "",
      "text": "println(userArtistCSVDF3.select(\"artistid\").distinct().count() - userArtistFinal.select(\"artistid\").distinct().count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:13:24+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "62902\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1741647325",
      "id": "paragraph_1608534980578_125051122",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:435"
    },
    {
      "title": "",
      "text": "createOrReplaceTempViewcreateOrReplaceTempView%sql\n\nselect \n    userid,\n    artistid,\n    count(playcount) as cnt\nfrom\n    userArtistFinal\ngroup by userid, artistid\nhaving\n    true\nand cnt > 1\norder by cnt desc\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:13:27+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "cnt": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tcnt\n2133748\t1018110\t94\n2052189\t1082784\t71\n2360120\t122\t68\n2302495\t1000024\t65\n1053375\t1001819\t57\n2214793\t1000130\t54\n2181817\t82\t48\n1000072\t1021625\t46\n2197708\t1005386\t43\n2117500\t1000881\t41\n2054029\t1001419\t41\n2360120\t1190\t40\n2017825\t1003694\t38\n2140727\t1026675\t33\n2054029\t2439\t33\n2197701\t1002646\t33\n2205665\t1116582\t32\n2205461\t10316280\t32\n2214793\t4481\t32\n1053335\t1000597\t32\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_882631427",
      "id": "paragraph_1659493935302_1215926490",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:436"
    },
    {
      "title": "",
      "text": "%sql\n\nselect \n    *\nfrom\n    userArtistFinal\nwhere\n    true\nand userid = 2133748\nand artistid = 1018110\n;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:35:46+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n2133748\t1018110\t11\n2133748\t1018110\t10\n2133748\t1018110\t12\n2133748\t1018110\t11\n2133748\t1018110\t6\n2133748\t1018110\t5\n2133748\t1018110\t4\n2133748\t1018110\t4\n2133748\t1018110\t7\n2133748\t1018110\t4\n2133748\t1018110\t6\n2133748\t1018110\t5\n2133748\t1018110\t6\n2133748\t1018110\t4\n2133748\t1018110\t4\n2133748\t1018110\t6\n2133748\t1018110\t6\n2133748\t1018110\t1313\n2133748\t1018110\t14\n2133748\t1018110\t8\n2133748\t1018110\t5\n2133748\t1018110\t8\n2133748\t1018110\t14\n2133748\t1018110\t13\n2133748\t1018110\t1\n2133748\t1018110\t7\n2133748\t1018110\t75\n2133748\t1018110\t8\n2133748\t1018110\t13\n2133748\t1018110\t6\n2133748\t1018110\t10\n2133748\t1018110\t8\n2133748\t1018110\t6\n2133748\t1018110\t6\n2133748\t1018110\t9\n2133748\t1018110\t8\n2133748\t1018110\t9\n2133748\t1018110\t13\n2133748\t1018110\t5\n2133748\t1018110\t14\n2133748\t1018110\t10\n2133748\t1018110\t8\n2133748\t1018110\t13\n2133748\t1018110\t10\n2133748\t1018110\t5\n2133748\t1018110\t11\n2133748\t1018110\t8\n2133748\t1018110\t7\n2133748\t1018110\t16\n2133748\t1018110\t7\n2133748\t1018110\t8\n2133748\t1018110\t10\n2133748\t1018110\t7\n2133748\t1018110\t5\n2133748\t1018110\t6\n2133748\t1018110\t5\n2133748\t1018110\t7\n2133748\t1018110\t5\n2133748\t1018110\t12\n2133748\t1018110\t11\n2133748\t1018110\t7\n2133748\t1018110\t5\n2133748\t1018110\t8\n2133748\t1018110\t6\n2133748\t1018110\t9\n2133748\t1018110\t13\n2133748\t1018110\t7\n2133748\t1018110\t7\n2133748\t1018110\t7\n2133748\t1018110\t6\n2133748\t1018110\t5\n2133748\t1018110\t12\n2133748\t1018110\t7\n2133748\t1018110\t6\n2133748\t1018110\t15\n2133748\t1018110\t7\n2133748\t1018110\t10\n2133748\t1018110\t10\n2133748\t1018110\t11\n2133748\t1018110\t5\n2133748\t1018110\t7\n2133748\t1018110\t11\n2133748\t1018110\t13\n2133748\t1018110\t10\n2133748\t1018110\t7\n2133748\t1018110\t5\n2133748\t1018110\t6\n2133748\t1018110\t8\n2133748\t1018110\t7\n2133748\t1018110\t13\n2133748\t1018110\t14\n2133748\t1018110\t5\n2133748\t1018110\t12\n2133748\t1018110\t7\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1512540574",
      "id": "paragraph_1659494315306_416382800",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:437"
    },
    {
      "title": "",
      "text": "%sql\n\nselect\n    *\nfrom \n    artistAliasFinal\nwhere\n    true\nand goodid = 1018110\n;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:35:52+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "badid": "string",
                      "goodid": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "badid\tgoodid\n1069921\t1018110\n1018110\t1018110\n1206230\t1018110\n6605197\t1018110\n6605196\t1018110\n6941378\t1018110\n6941385\t1018110\n2059367\t1018110\n2059672\t1018110\n2059482\t1018110\n2059701\t1018110\n2059404\t1018110\n2059515\t1018110\n2059754\t1018110\n2059547\t1018110\n2059631\t1018110\n2059531\t1018110\n2059241\t1018110\n7023397\t1018110\n7023407\t1018110\n7023423\t1018110\n7023442\t1018110\n7023463\t1018110\n7023480\t1018110\n7023494\t1018110\n6697103\t1018110\n1252888\t1018110\n1090604\t1018110\n1098867\t1018110\n6606699\t1018110\n1246616\t1018110\n2088112\t1018110\n6926804\t1018110\n9937977\t1018110\n1237497\t1018110\n10013938\t1018110\n10118259\t1018110\n7023513\t1018110\n7023522\t1018110\n7023537\t1018110\n7025519\t1018110\n7035006\t1018110\n7035100\t1018110\n10006988\t1018110\n10006998\t1018110\n10007044\t1018110\n10007189\t1018110\n10007311\t1018110\n10008696\t1018110\n10008778\t1018110\n10008819\t1018110\n10008894\t1018110\n10008981\t1018110\n10009019\t1018110\n10015043\t1018110\n10031178\t1018110\n6607672\t1018110\n9928270\t1018110\n9927693\t1018110\n9927686\t1018110\n9914047\t1018110\n9914032\t1018110\n10342306\t1018110\n10357181\t1018110\n10357899\t1018110\n10359180\t1018110\n10378339\t1018110\n10378547\t1018110\n9898278\t1018110\n10023663\t1018110\n10032965\t1018110\n9898396\t1018110\n9898453\t1018110\n9898721\t1018110\n9913770\t1018110\n10032922\t1018110\n10034629\t1018110\n10035573\t1018110\n10039202\t1018110\n10048458\t1018110\n10099611\t1018110\n10250581\t1018110\n10243609\t1018110\n10251607\t1018110\n10322482\t1018110\n2088286\t1018110\n9930484\t1018110\n9931282\t1018110\n9931527\t1018110\n9932107\t1018110\n9932284\t1018110\n9932606\t1018110\n9933344\t1018110\n9933902\t1018110\n9933911\t1018110\n9933995\t1018110\n9939675\t1018110\n9939831\t1018110\n9940220\t1018110\n9940284\t1018110\n9940496\t1018110\n9940614\t1018110\n9941062\t1018110\n9941733\t1018110\n9948179\t1018110\n9948357\t1018110\n9948837\t1018110\n9949025\t1018110\n9949159\t1018110\n9949182\t1018110\n9934114\t1018110\n9949466\t1018110\n7035034\t1018110\n9898430\t1018110\n9898472\t1018110\n9906292\t1018110\n9939859\t1018110\n9950029\t1018110\n9950676\t1018110\n9953217\t1018110\n9953236\t1018110\n9953418\t1018110\n9954068\t1018110\n9954150\t1018110\n9954987\t1018110\n9955846\t1018110\n9956230\t1018110\n9956310\t1018110\n9956601\t1018110\n9957752\t1018110\n9958305\t1018110\n9955358\t1018110\n9953811\t1018110\n2142548\t1018110\n10278151\t1018110\n9950764\t1018110\n9952426\t1018110\n9952474\t1018110\n9952534\t1018110\n9952773\t1018110\n9958591\t1018110\n9958749\t1018110\n9962201\t1018110\n9962254\t1018110\n9962410\t1018110\n9962472\t1018110\n9962707\t1018110\n9962720\t1018110\n9962868\t1018110\n9963613\t1018110\n9973518\t1018110\n9973566\t1018110\n1343261\t1018110\n1175986\t1018110\n2077501\t1018110\n2078710\t1018110\n2078723\t1018110\n2078735\t1018110\n2078760\t1018110\n2078744\t1018110\n2078774\t1018110\n2078788\t1018110\n2081903\t1018110\n6718764\t1018110\n1204941\t1018110\n1206688\t1018110\n1211005\t1018110\n1304848\t1018110\n1118279\t1018110\n1130964\t1018110\n1092819\t1018110\n6811626\t1018110\n6941390\t1018110\n6966780\t1018110\n9957286\t1018110\n9967495\t1018110\n9977893\t1018110\n1172508\t1018110\n1206194\t1018110\n6607505\t1018110\n1254728\t1018110\n2102757\t1018110\n6777349\t1018110\n1262764\t1018110\n6998061\t1018110\n7008645\t1018110\n7012522\t1018110\n10103537\t1018110\n10104240\t1018110\n10243793\t1018110\n10316610\t1018110\n10343867\t1018110\n10381757\t1018110\n9929450\t1018110\n9952269\t1018110\n9954782\t1018110\n9955282\t1018110\n9993685\t1018110\n1209711\t1018110\n10376493\t1018110\n2059271\t1018110\n2059354\t1018110\n1095214\t1018110\n2142530\t1018110\n2142504\t1018110\n2142493\t1018110\n2142478\t1018110\n2142470\t1018110\n2142464\t1018110\n2142454\t1018110\n2142442\t1018110\n2142429\t1018110\n2142540\t1018110\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1918235361",
      "id": "paragraph_1659495775829_1405762027",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:438"
    },
    {
      "title": "",
      "text": "%sql\n\nselect \n    userid,\n    artistid,\n    sum(playcount) as playcount\nfrom\n    userArtistFinal\ngroup by userid, artistid\norder by playcount desc\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:13:36+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "title": false,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n2023977\t1007903\t62815\n2023977\t2823\t51039\n2014936\t82\t36083\n2069337\t1006134\t34800\n2013784\t1004059\t32768\n2069337\t1007027\t31321\n1073435\t1105069\t30043\n2023977\t1000156\t29983\n1052225\t1256375\t29933\n2017397\t1000427\t26394\n1045479\t1000113\t26135\n2062243\t6901343\t26107\n1039100\t1275996\t25858\n1053554\t478\t25303\n2017397\t1004296\t24876\n2216281\t5705\t24067\n1039908\t979\t23815\n2023977\t1004278\t23095\n1061830\t1000024\t22924\n2069337\t1000112\t22480\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_1265921778",
      "id": "paragraph_1659494592652_1793415590",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:439"
    },
    {
      "title": "",
      "text": "val userArtistFinal2 = userArtistFinal\n    .groupBy(\"userid\", \"artistid\")\n    .agg(sum(\"playcount\").as(\"playcount\"))\n    .filter(\"playcount <= 64800\") \n\nuserArtistFinal2.persist(org.apache.spark.storage.StorageLevel.MEMORY_ONLY)    \nprintln(userArtistFinal2.count())\nuserArtistFinal2.printSchema()\nuserArtistFinal2.show()\nz.show(userArtistFinal2.limit(20))\n\nuserArtistFinal2.createOrReplaceTempView(\"userArtistFinal2\")\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:35:58+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "24133299\nroot\n |-- userid: integer (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- playcount: long (nullable = true)\n\n+-------+--------+---------+\n| userid|artistid|playcount|\n+-------+--------+---------+\n|2044660| 1233220|        1|\n|2044660|    1707|        3|\n|2044661| 1100169|       22|\n|2044662| 1013095|       26|\n|2044662|     250|        1|\n|2044662|     251|       21|\n|2044703| 1011794|        1|\n|2044703|    1706|       27|\n|2044710| 1066962|        1|\n|2044731| 1005686|        1|\n|2044731| 1011036|        1|\n|2044731|     463|        2|\n|2044741| 1022845|        1|\n|2044742|    1177|      101|\n|2044754| 1007569|        1|\n|2044754| 1036094|        1|\n|2044758| 2038336|        4|\n|2044761| 1001167|        9|\n|2044761|10297587|       39|\n|2044762| 2087755|        5|\n+-------+--------+---------+\nonly showing top 20 rows\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n2044660\t1233220\t1\n2044660\t1707\t3\n2044661\t1100169\t22\n2044662\t1013095\t26\n2044662\t250\t1\n2044662\t251\t21\n2044703\t1011794\t1\n2044703\t1706\t27\n2044710\t1066962\t1\n2044731\t1005686\t1\n2044731\t1011036\t1\n2044731\t463\t2\n2044741\t1022845\t1\n2044742\t1177\t101\n2044754\t1007569\t1\n2044754\t1036094\t1\n2044758\t2038336\t4\n2044761\t1001167\t9\n2044761\t10297587\t39\n2044762\t2087755\t5\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserArtistFinal2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022225_7423213",
      "id": "paragraph_1659494873406_549388839",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:440"
    },
    {
      "title": "",
      "text": "println(userArtistFinal.count() - userArtistFinal2.count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:13:42+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "163553\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022226_651398780",
      "id": "paragraph_1659495224007_525512096",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:441"
    },
    {
      "title": "",
      "text": "userArtistFinal2.persist(org.apache.spark.storage.StorageLevel.MEMORY_ONLY) // userid_artistid_playcount\nprintln(userArtistFinal2.count())\n\nartistFinal.cache()  // artistid_name\nprintln(artistFinal.count())\nartistAliasFinal.persist()  // badid_goodid\nprintln(artistAliasFinal.count())\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:36:21+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "24133299\n1848280\n190892\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022226_1759433361",
      "id": "20200818-065415_1029409974",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:442"
    },
    {
      "title": "",
      "text": "userArtistFinal2.unpersist()\n\nartistFinal.unpersist()\nartistAliasFinal.unpersist()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:36:42+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mres85\u001b[0m: \u001b[1m\u001b[32martistAliasFinal.type\u001b[0m = [badid: int, goodid: int]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022226_385341961",
      "id": "20200818-073844_646688909",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:443"
    },
    {
      "title": "Cassandra",
      "text": "%sql\n\nselect \n    *\nfrom\n    mycatalog.mykeyspace.user_artist_data\nlimit 20;\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:14:32+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "sql",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/sql",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022226_2105674541",
      "id": "paragraph_1659532300717_283090033",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:446"
    },
    {
      "title": "[Cassandra] 최종 학습 데이터 저장....",
      "text": "userArtistFinal2.printSchema\n\nuserArtistFinal2\n    .limit(100000) \n    .writeTo(\"mycatalog.mykeyspace.user_artist_data\")\n    .append\n    ",
      "user": "anonymous",
      "dateUpdated": "2023-04-03T16:13:42+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- playcount: long (nullable = true)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022226_1706625364",
      "id": "paragraph_1659531886142_436849752",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:448"
    },
    {
      "title": "",
      "text": "val userArtistFinal3 = spark.table(\"mycatalog.mykeyspace.user_artist_data\")\n\nuserArtistFinal3.persist(org.apache.spark.storage.StorageLevel.MEMORY_ONLY) \nprintln(userArtistFinal3.count())\n\nuserArtistFinal3.printSchema\nuserArtistFinal3.show\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:16:01+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "tableHide": false,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- artistid: integer (nullable = true)\n |-- playcount: long (nullable = true)\n\n+-------+--------+---------+\n| userid|artistid|playcount|\n+-------+--------+---------+\n|2198341| 9909362|        1|\n|2180047|     722|        3|\n|2180047|    1212|       13|\n|2180047| 1285410|       10|\n|2388075| 1004294|        1|\n|2405941| 1268623|        9|\n|2034229|     827|        5|\n|2034229|    4192|       41|\n|2034229|    5332|        1|\n|2034229| 1001884|       34|\n|2034229| 1002128|       86|\n|2034229| 1002906|        4|\n|2389194|10581044|        5|\n|2419239| 1090286|       29|\n|1065249| 1000953|        5|\n|1065249| 1036474|        1|\n|1065249| 1103336|        2|\n|1065249| 6625005|        1|\n|2028343| 1005193|        1|\n|2028343| 1013888|        9|\n+-------+--------+---------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34muserArtistFinal3\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022226_959691314",
      "id": "paragraph_1659531956728_148184463",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:450"
    },
    {
      "title": "ALS Setting parameters",
      "text": "import org.apache.spark.ml.recommendation.ALS\n\nval als = new ALS()\n    .setUserCol(\"userid\")\n    .setItemCol(\"artistid\")\n    .setRatingCol(\"playcount\")\n    .setImplicitPrefs(true)\n    .setMaxIter(5)\n    .setRegParam(0.1)  \n    .setAlpha(40)  \n    .setRank(10) \n    .setColdStartStrategy(\"drop\") \n    .setSeed(11L)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:16:37+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.recommendation.ALS\n\u001b[1m\u001b[34mals\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALS\u001b[0m = als_d3c63750e5fa\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_868475937",
      "id": "20200519-131347_436198935",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:452"
    },
    {
      "title": "",
      "text": "println(\"\\n>>>> als.explainParams()\")\nprintln(als.explainParams())\n\nprintln(\"\\n\\n>>>> als.extractParamMap()\")\nals.extractParamMap()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:16:52+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\n>>>> als.explainParams()\nalpha: alpha for implicit preference (default: 1.0, current: 40.0)\nblockSize: block size for stacking input data in matrices. Data is stacked within partitions. If block size is more than remaining data in a partition then it is adjusted to the size of this data. (default: 4096)\ncheckpointInterval: set checkpoint interval (>= 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations. Note: this setting will be ignored if the checkpoint directory is not set in the SparkContext (default: 10)\ncoldStartStrategy: strategy for dealing with unknown or new users/items at prediction time. This may be useful in cross-validation or production scenarios, for handling user/item ids the model has not seen in the training data. Supported values: nan,drop. (default: nan, current: drop)\nfinalStorageLevel: StorageLevel for ALS model factors. (default: MEMORY_AND_DISK)\nimplicitPrefs: whether to use implicit preference (default: false, current: true)\nintermediateStorageLevel: StorageLevel for intermediate datasets. Cannot be 'NONE'. (default: MEMORY_AND_DISK)\nitemCol: column name for item ids. Ids must be within the integer value range. (default: item, current: artistid)\nmaxIter: maximum number of iterations (>= 0) (default: 10, current: 5)\nnonnegative: whether to use nonnegative constraint for least squares (default: false)\nnumItemBlocks: number of item blocks (default: 10)\nnumUserBlocks: number of user blocks (default: 10)\npredictionCol: prediction column name (default: prediction)\nrank: rank of the factorization (default: 10, current: 10)\nratingCol: column name for ratings (default: rating, current: playcount)\nregParam: regularization parameter (>= 0) (default: 0.1, current: 0.1)\nseed: random seed (default: 1994790107, current: 11)\nuserCol: column name for user ids. Ids must be within the integer value range. (default: user, current: userid)\n\n\n>>>> als.extractParamMap()\n\u001b[1m\u001b[34mres68\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.param.ParamMap\u001b[0m =\n{\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-blockSize: 4096,\n\tals_d3c63750e5fa-checkpointInterval: 10,\n\tals_d3c63750e5fa-coldStartStrategy: drop,\n\tals_d3c63750e5fa-finalStorageLevel: MEMORY_AND_DISK,\n\tals_d3c63750e5fa-implicitPrefs: true,\n\tals_d3c63750e5fa-intermediateStorageLevel: MEMORY_AND_DISK,\n\tals_d3c63750e5fa-itemCol: artistid,\n\tals_d3c63750e5fa-maxIter: 5,\n\tals_d3c63750e5fa-nonnegative: false,\n\tals_d3c63750e5fa-numItemBlocks: 10,\n\tals_d3c63750e5fa-numUserBlocks: 10,\n\tals_d3c63750e5fa-predictionCol: prediction,\n\tals_d3c63750e5fa-rank: 10,\n\tals_d3c63750e5fa-ratingCol: playcount,\n\tals_d3c63750e5fa-regParam: 0.1,\n\tals_d3c63750e5fa-seed: 11,\n\tals_d3c63750e5fa-userCol: userid\n}\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_1577148537",
      "id": "20200519-132720_1221743481",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:453"
    },
    {
      "title": "ALS Traning",
      "text": "userArtistFinal3.printSchema()\n\nval alsModel = als.fit(userArtistFinal3)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:36:54+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- artistid: integer (nullable = true)\n |-- playcount: long (nullable = true)\n\n\u001b[1m\u001b[34malsModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALSModel\u001b[0m = ALSModel: uid=als_d3c63750e5fa, rank=10\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_1978144145",
      "id": "20200519-132713_1451983664",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:454"
    },
    {
      "title": "User Tesing",
      "text": "userArtistFinal3\n    .groupBy(\"userid\")\n    .agg(count(\"artistid\").as(\"count_artist\"), sum(\"playcount\").as(\"sum_playcount\"))\n    .where(\"count_artist >= 20\")\n    .orderBy($\"count_artist\".asc, $\"sum_playcount\".desc)\n    .show()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:17:48+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+------------+-------------+\n| userid|count_artist|sum_playcount|\n+-------+------------+-------------+\n|1001440|          20|         1220|\n|2010008|          20|          432|\n|1021923|          20|          122|\n|1050213|          20|           68|\n|2003456|          20|           45|\n|2041212|          22|           58|\n|1006093|          23|           92|\n|1004584|          24|          228|\n|1036694|          24|           64|\n|2023686|          25|          250|\n|1024631|          27|          390|\n|1059334|          29|          268|\n|2016026|          29|          256|\n|2232770|          29|          108|\n|2030067|          38|           86|\n+-------+------------+-------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_1018679584",
      "id": "20200818-075403_1868081422",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:456"
    },
    {
      "title": "Traning ALS Model Recommendation",
      "text": "val userDS = Seq(1001440, 2010008, 987654321)\n    .toDF(\"userID\")\n    .as[Int]  // Dataset으로 형변환\n\nuserDS.printSchema\nuserDS.show(false)\n\n// 추천 5개\nval recommendedForSomeUsersDF = alsModel.recommendForUserSubset(userDS, 5)\nrecommendedForSomeUsersDF.printSchema\nrecommendedForSomeUsersDF.show(false)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:18:34+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userID: integer (nullable = false)\n\n+---------+\n|userID   |\n+---------+\n|1001440  |\n|2010008  |\n|987654321|\n+---------+\n\nroot\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n\n+-------+-----------------------------------------------------------------------------------------------------+\n|userid |recommendations                                                                                      |\n+-------+-----------------------------------------------------------------------------------------------------+\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |\n+-------+-----------------------------------------------------------------------------------------------------+\n\n\u001b[1m\u001b[34muserDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[Int]\u001b[0m = [userID: int]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_1967605533",
      "id": "20200523-023158_1222020943",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:457"
    },
    {
      "title": "Traning ALS Model Recommendation Exist User & New User",
      "text": "val userDS = Seq(1001440, 2010008, 987654321)\n    .toDF(\"userID\")\n    .as[Int]\n\nuserDS.printSchema\nuserDS.show(false)\n\n//추천 5개\nval recommendedForSomeUsersDF = alsModel.recommendForUserSubset(userDS, 5)\nrecommendedForSomeUsersDF.printSchema\nrecommendedForSomeUsersDF.show(false)\n\nval recommendedForSomeUsersDF2 = recommendedForSomeUsersDF\n    .withColumn(\"recommend\", explode($\"recommendations\"))\n    .withColumn(\"artistid\", $\"recommend.artistid\")\n    .withColumn(\"rating\", $\"recommend.rating\")\n\nrecommendedForSomeUsersDF2.printSchema()\nrecommendedForSomeUsersDF2.show(false)\nprintln(recommendedForSomeUsersDF2.count())\n\nval recommendedForSomeUsersDF3 = recommendedForSomeUsersDF2\n    .drop(\"recommendations\", \"recommend\")\n\nrecommendedForSomeUsersDF3.printSchema()\nrecommendedForSomeUsersDF3.show(false)\nprintln(recommendedForSomeUsersDF3.count())\n\nval recommendedForSomeUsersDF4 = recommendedForSomeUsersDF3.as(\"reco\")\n    .join(artistFinal.as(\"art\"), $\"reco.artistid\" === $\"art.artistid\")\n    .orderBy($\"userid\".asc, $\"rating\".desc)\n\nrecommendedForSomeUsersDF4.show(false)\nz.show(recommendedForSomeUsersDF4)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:37:11+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "rating": "string",
                      "artistname": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userID: integer (nullable = false)\n\n+---------+\n|userID   |\n+---------+\n|1001440  |\n|2010008  |\n|987654321|\n+---------+\n\nroot\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n\n+-------+-----------------------------------------------------------------------------------------------------+\n|userid |recommendations                                                                                      |\n+-------+-----------------------------------------------------------------------------------------------------+\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |\n+-------+-----------------------------------------------------------------------------------------------------+\n\nroot\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n |-- recommend: struct (nullable = true)\n |    |-- artistid: integer (nullable = true)\n |    |-- rating: float (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- rating: float (nullable = true)\n\n+-------+-----------------------------------------------------------------------------------------------------+--------------------+--------+---------+\n|userid |recommendations                                                                                      |recommend           |artistid|rating   |\n+-------+-----------------------------------------------------------------------------------------------------+--------------------+--------+---------+\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|{873, 3.0207484}    |873     |3.0207484|\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|{1008419, 2.5889916}|1008419 |2.5889916|\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|{189, 1.965459}     |189     |1.965459 |\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|{1000113, 1.9309133}|1000113 |1.9309133|\n|1001440|[{873, 3.0207484}, {1008419, 2.5889916}, {189, 1.965459}, {1000113, 1.9309133}, {1000632, 1.8974508}]|{1000632, 1.8974508}|1000632 |1.8974508|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |{873, 2.3198502}    |873     |2.3198502|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |{478, 2.2835698}    |478     |2.2835698|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |{1275996, 1.8885468}|1275996 |1.8885468|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |{976, 1.8489277}    |976     |1.8489277|\n|2010008|[{873, 2.3198502}, {478, 2.2835698}, {1275996, 1.8885468}, {976, 1.8489277}, {1000952, 1.4801197}]   |{1000952, 1.4801197}|1000952 |1.4801197|\n+-------+-----------------------------------------------------------------------------------------------------+--------------------+--------+---------+\n\n10\nroot\n |-- userid: integer (nullable = false)\n |-- artistid: integer (nullable = true)\n |-- rating: float (nullable = true)\n\n+-------+--------+---------+\n|userid |artistid|rating   |\n+-------+--------+---------+\n|1001440|873     |3.0207484|\n|1001440|1008419 |2.5889916|\n|1001440|189     |1.965459 |\n|1001440|1000113 |1.9309133|\n|1001440|1000632 |1.8974508|\n|2010008|873     |2.3198502|\n|2010008|478     |2.2835698|\n|2010008|1275996 |1.8885468|\n|2010008|976     |1.8489277|\n|2010008|1000952 |1.4801197|\n+-------+--------+---------+\n\n10\n+-------+--------+---------+--------+----------------+\n|userid |artistid|rating   |artistid|artistname      |\n+-------+--------+---------+--------+----------------+\n|1001440|873     |3.0207484|873     |Tool            |\n|1001440|1008419 |2.5889916|1008419 |Nightwish       |\n|1001440|189     |1.965459 |189     |The Cure        |\n|1001440|1000113 |1.9309133|1000113 |The Beatles     |\n|1001440|1000632 |1.8974508|1000632 |Goo Goo Dolls   |\n|2010008|873     |2.3198502|873     |Tool            |\n|2010008|478     |2.2835698|478     |Boards of Canada|\n|2010008|1275996 |1.8885468|1275996 |R.E.M.          |\n|2010008|976     |1.8489277|976     |Nirvana         |\n|2010008|1000952 |1.4801197|1000952 |The Strokes     |\n+-------+--------+---------+--------+----------------+\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\trating\tartistid\tartistname\n1001440\t873\t3.0207484\t873\tTool\n1001440\t1008419\t2.5889916\t1008419\tNightwish\n1001440\t189\t1.965459\t189\tThe Cure\n1001440\t1000113\t1.9309133\t1000113\tThe Beatles\n1001440\t1000632\t1.8974508\t1000632\tGoo Goo Dolls\n2010008\t873\t2.3198502\t873\tTool\n2010008\t478\t2.2835698\t478\tBoards of Canada\n2010008\t1275996\t1.8885468\t1275996\tR.E.M.\n2010008\t976\t1.8489277\t976\tNirvana\n2010008\t1000952\t1.4801197\t1000952\tThe Strokes\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[Int]\u001b[0m = [userID: int]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>>]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>> ... 3 more fields]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF3\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 1 more field]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF4\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_2093028643",
      "id": "20200818-054951_1685215749",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:458"
    },
    {
      "title": "",
      "text": "val historyForSomeUsersDF = userArtistFinal3\n    .where(\"userid in (1001440, 2010008)\").as(\"history\")\n    .join(artistFinal.as(\"art\"), $\"history.artistid\" === $\"art.artistid\")\n    .orderBy($\"userid\".asc, $\"playcount\".desc)\n\nhistoryForSomeUsersDF.show(40, false)\nz.show(historyForSomeUsersDF)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:19:26+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string",
                      "artistname": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------+---------+--------+--------------------------------------------------------------------+\n|userid |artistid|playcount|artistid|artistname                                                          |\n+-------+--------+---------+--------+--------------------------------------------------------------------+\n|1001440|1006165 |374      |1006165 |Non Phixion                                                         |\n|1001440|1116978 |324      |1116978 |Dave Brockie Experience                                             |\n|1001440|2439    |209      |2439    |HiM                                                                 |\n|1001440|1008602 |138      |1008602 |Kool Keith                                                          |\n|1001440|1014801 |75       |1014801 |Soma                                                                |\n|1001440|2086679 |16       |2086679 |Lunatica                                                            |\n|1001440|1175773 |15       |1175773 |Faun                                                                |\n|1001440|1118265 |15       |1118265 |Wretched Ones                                                       |\n|1001440|1015854 |13       |1015854 |Celldweller                                                         |\n|1001440|2042795 |11       |2042795 |Nikki Boyer                                                         |\n|1001440|1058122 |6        |1058122 |Jah Cure                                                            |\n|1001440|316     |5        |316     |Yes                                                                 |\n|1001440|5210    |4        |5210    |Lemon Jelly                                                         |\n|1001440|1303746 |3        |1303746 |Chingon                                                             |\n|1001440|1014842 |3        |1014842 |Toby Dammit                                                         |\n|1001440|1040764 |2        |1040764 |Henry Cowell                                                        |\n|1001440|2013402 |2        |2013402 |Das 5. Element                                                      |\n|1001440|6873894 |2        |6873894 |The Reducers                                                        |\n|1001440|6640131 |2        |6640131 |Ergo Phizmiz & His Orchestra                                        |\n|1001440|1169189 |1        |1169189 |Tories                                                              |\n|2010008|1921    |219      |1921    |John Fahey                                                          |\n|2010008|1007885 |107      |1007885 |Jay Farrar                                                          |\n|2010008|1003559 |49       |1003559 |Austin Lounge Lizards                                               |\n|2010008|2042664 |9        |2042664 |Titus Turner                                                        |\n|2010008|2087218 |6        |2087218 |abijah                                                              |\n|2010008|1038758 |5        |1038758 |Rev. J. M. Gates                                                    |\n|2010008|1007238 |5        |1007238 |Archer Prewitt                                                      |\n|2010008|1002648 |5        |1002648 |Men Without Hats                                                    |\n|2010008|1010987 |5        |1010987 |Albert Ammons                                                       |\n|2010008|6815046 |3        |6815046 |Johnny Burnette's Rock 'n' Roll Trio                                |\n|2010008|6782375 |3        |6782375 |Tennessee Ernie Ford & Ella Mae Morse With Cliffie Stone's Orchestra|\n|2010008|2653    |3        |2653    |Andreas Vollenweider                                                |\n|2010008|1062330 |3        |1062330 |Brad Paisley                                                        |\n|2010008|6693678 |2        |6693678 |Red Rodney Sextet                                                   |\n|2010008|1863    |2        |1863    |Talk Talk                                                           |\n|2010008|1276665 |2        |1276665 |Sintesis                                                            |\n|2010008|1127591 |1        |1127591 |Jazz Greats                                                         |\n|2010008|6666860 |1        |6666860 |Sorrows, The                                                        |\n|2010008|868     |1        |868     |The Roots                                                           |\n|2010008|6723364 |1        |6723364 |Hou                                                                 |\n+-------+--------+---------+--------+--------------------------------------------------------------------+\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\tplaycount\tartistid\tartistname\n1001440\t1006165\t374\t1006165\tNon Phixion\n1001440\t1116978\t324\t1116978\tDave Brockie Experience\n1001440\t2439\t209\t2439\tHiM\n1001440\t1008602\t138\t1008602\tKool Keith\n1001440\t1014801\t75\t1014801\tSoma\n1001440\t2086679\t16\t2086679\tLunatica\n1001440\t1118265\t15\t1118265\tWretched Ones\n1001440\t1175773\t15\t1175773\tFaun\n1001440\t1015854\t13\t1015854\tCelldweller\n1001440\t2042795\t11\t2042795\tNikki Boyer\n1001440\t1058122\t6\t1058122\tJah Cure\n1001440\t316\t5\t316\tYes\n1001440\t5210\t4\t5210\tLemon Jelly\n1001440\t1303746\t3\t1303746\tChingon\n1001440\t1014842\t3\t1014842\tToby Dammit\n1001440\t1040764\t2\t1040764\tHenry Cowell\n1001440\t2013402\t2\t2013402\tDas 5. Element\n1001440\t6873894\t2\t6873894\tThe Reducers\n1001440\t6640131\t2\t6640131\tErgo Phizmiz & His Orchestra\n1001440\t1169189\t1\t1169189\tTories\n2010008\t1921\t219\t1921\tJohn Fahey\n2010008\t1007885\t107\t1007885\tJay Farrar\n2010008\t1003559\t49\t1003559\tAustin Lounge Lizards\n2010008\t2042664\t9\t2042664\tTitus Turner\n2010008\t2087218\t6\t2087218\tabijah\n2010008\t1010987\t5\t1010987\tAlbert Ammons\n2010008\t1038758\t5\t1038758\tRev. J. M. Gates\n2010008\t1002648\t5\t1002648\tMen Without Hats\n2010008\t1007238\t5\t1007238\tArcher Prewitt\n2010008\t6782375\t3\t6782375\tTennessee Ernie Ford & Ella Mae Morse With Cliffie Stone's Orchestra\n2010008\t2653\t3\t2653\tAndreas Vollenweider\n2010008\t6815046\t3\t6815046\tJohnny Burnette's Rock 'n' Roll Trio\n2010008\t1062330\t3\t1062330\tBrad Paisley\n2010008\t1276665\t2\t1276665\tSintesis\n2010008\t1863\t2\t1863\tTalk Talk\n2010008\t6693678\t2\t6693678\tRed Rodney Sextet\n2010008\t1127591\t1\t1127591\tJazz Greats\n2010008\t868\t1\t868\tThe Roots\n2010008\t6666860\t1\t6666860\tSorrows, The\n2010008\t6723364\t1\t6723364\tHou\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mhistoryForSomeUsersDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_439982163",
      "id": "20200818-030509_547295394",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:459"
    },
    {
      "title": "",
      "text": "val predictionsDF = alsModel.transform(userArtistFinal3)\npredictionsDF.printSchema\n\npredictionsDF\n    .orderBy($\"prediction\".desc)\n    .show(false)\n\npredictionsDF\n    .orderBy($\"prediction\".asc)\n    .show(false)\n    ",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:19:33+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- artistid: integer (nullable = true)\n |-- playcount: long (nullable = true)\n |-- prediction: float (nullable = false)\n\n+-------+--------+---------+----------+\n|userid |artistid|playcount|prediction|\n+-------+--------+---------+----------+\n|2012264|606     |1        |1.3908793 |\n|2186780|4267    |2        |1.3649895 |\n|1049648|1177    |1        |1.225757  |\n|1056115|232     |2        |1.2195886 |\n|2014065|478     |1        |1.1788704 |\n|2083820|1259    |3        |1.146526  |\n|2186780|3402    |3        |1.1368479 |\n|2417855|153     |1        |1.1352712 |\n|1004584|1007614 |3        |1.133472  |\n|5628   |478     |1        |1.129298  |\n|2016026|2600    |3        |1.0952474 |\n|2171163|831     |1        |1.0948521 |\n|2006883|1002287 |3        |1.0844523 |\n|1042681|1177    |3        |1.0772966 |\n|2127105|3437    |7        |1.0726007 |\n|2211680|313     |5        |1.0584273 |\n|1042300|3170    |7        |1.0545208 |\n|1049682|1006016 |5        |1.05168   |\n|2053961|1001646 |10       |1.0497994 |\n|2017169|1000113 |3        |1.049649  |\n+-------+--------+---------+----------+\nonly showing top 20 rows\n\n+-------+--------+---------+-----------+\n|userid |artistid|playcount|prediction |\n+-------+--------+---------+-----------+\n|1000199|1270639 |1        |-0.84841347|\n|1071910|4209    |1        |-0.49527192|\n|1037480|3677    |1        |-0.49498826|\n|2090265|598     |1        |-0.4681523 |\n|2107211|621     |2        |-0.45813462|\n|2035295|1000416 |1        |-0.45612884|\n|2203002|1000130 |1        |-0.44496265|\n|2072743|1101322 |1        |-0.43907028|\n|2008052|1199    |1        |-0.42040512|\n|2038323|176     |1        |-0.4200311 |\n|2052824|1004464 |1        |-0.41451222|\n|2167425|4154    |1        |-0.39576325|\n|1077320|1251    |1        |-0.36445346|\n|2205913|1001529 |1        |-0.3594547 |\n|2004458|1000271 |1        |-0.3511068 |\n|2070081|5606    |1        |-0.34302875|\n|1044905|300     |1        |-0.34185976|\n|2175071|1000302 |2        |-0.34040746|\n|2197610|4569    |1        |-0.33995634|\n|2148886|1234472 |1        |-0.33824337|\n+-------+--------+---------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mpredictionsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022227_627278956",
      "id": "20200523-023203_1152857674",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:460"
    },
    {
      "title": "Model Evaluator (RMSE) Setting",
      "text": "import org.apache.spark.ml.evaluation.RegressionEvaluator\n\nval regEval = new RegressionEvaluator()\n    .setLabelCol(\"playcount\")\n    .setPredictionCol(\"prediction\")\n    .setMetricName(\"rmse\")\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:20:31+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.evaluation.RegressionEvaluator\n\u001b[1m\u001b[34mregEval\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.RegressionEvaluator\u001b[0m = RegressionEvaluator: uid=regEval_59c9e4d59b77, metricName=rmse, throughOrigin=false\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022228_708110005",
      "id": "20200523-023202_571805471",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:462"
    },
    {
      "title": "Model Evaluator Score (RMSE)",
      "text": "val rmse = regEval.evaluate(predictionsDF)\n\nprintln(rmse)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:20:43+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "96.90680518396537\n\u001b[1m\u001b[34mrmse\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 96.90680518396537\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022228_1700477156",
      "id": "20200523-023200_1105031346",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:463"
    },
    {
      "title": "Hyperparameter stage 1",
      "text": "import org.apache.spark.ml.{Pipeline, PipelineModel}\n\nval pipeline = new Pipeline()\n    .setStages(Array(als))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:22:55+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.{Pipeline, PipelineModel}\n\u001b[1m\u001b[34mpipeline\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.Pipeline\u001b[0m = pipeline_3a1f9bf2db56\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022228_972805166",
      "id": "20200523-031224_1645944190",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:465"
    },
    {
      "title": "ParamMap",
      "text": "import org.apache.spark.ml.tuning.ParamGridBuilder\n\nval paramMaps = new ParamGridBuilder()\n    .addGrid(als.alpha, Array(40.0, 1.0))\n    .addGrid(als.rank, Array(2, 3))\n    .addGrid(als.regParam, Array(1.0, 0.01))\n    .build()\n\nprintln(paramMaps.mkString(\", \"))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:21:23+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "{\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n}, {\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n}\nimport org.apache.spark.ml.tuning.ParamGridBuilder\n\u001b[1m\u001b[34mparamMaps\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.param.ParamMap]\u001b[0m =\nArray({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n}, {\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n}, {\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022231_2009286473",
      "id": "20200523-032010_1673648677",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:466"
    },
    {
      "title": "CrossValidator",
      "text": "import org.apache.spark.ml.tuning.CrossValidator\n\nval cv = new CrossValidator()\n    .setEstimator(pipeline)  \n    .setEstimatorParamMaps(paramMaps)  \n    .setEvaluator(regEval)  \n    .setNumFolds(2) \n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:21:40+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.tuning.CrossValidator\n\u001b[1m\u001b[34mcv\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.tuning.CrossValidator\u001b[0m = cv_e6e4c5d3af4f\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_1251930527",
      "id": "20200523-032138_1227719098",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:467"
    },
    {
      "title": "Split Data (Train, Test)",
      "text": "val Array(trainDS, testDS) = userArtistFinal3.randomSplit(Array(0.7, 0.3), 11L)\n\nprintln(userArtistFinal3.count)\n\ntrainDS.persist(org.apache.spark.storage.StorageLevel.MEMORY_ONLY)\nprintln(trainDS.count)\n\ntestDS.persist(org.apache.spark.storage.StorageLevel.MEMORY_ONLY)\nprintln(testDS.count)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:22:00+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "100000\n69767\n30233\n\u001b[1m\u001b[34mtrainDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 1 more field]\n\u001b[1m\u001b[34mtestDS\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 1 more field]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_1104317909",
      "id": "20200523-032442_1691494901",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:468"
    },
    {
      "title": "CrossValidator Traning",
      "text": "import org.apache.spark.ml.tuning.CrossValidatorModel\n\nval cvModel = cv.fit(trainDS)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:22:06+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.tuning.CrossValidatorModel\n\u001b[1m\u001b[34mcvModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.tuning.CrossValidatorModel\u001b[0m = CrossValidatorModel: uid=cv_e6e4c5d3af4f, bestModel=pipeline_3a1f9bf2db56, numFolds=2\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_1457293778",
      "id": "20200523-032246_201069757",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:469"
    },
    {
      "title": "Best Model",
      "text": "println(\"\\n>>>> Best Model : \\n\" + cvModel.bestModel)\nprintln(\"\\n>>>> Avg Metrics : \\n\" + cvModel.avgMetrics.mkString(\"\\n\"))\nprintln(\"\\n>>>> Estimator ParamMaps : \\n\" + cvModel.getEstimatorParamMaps.mkString(\"\\n\"))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:22:11+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\n>>>> Best Model : \npipeline_3a1f9bf2db56\n\n>>>> Avg Metrics : \n86.39992432078058\n86.39991730841524\n86.39560910640768\n86.3955658514239\n86.4003022511408\n86.40029509456177\n86.3995357710174\n86.39925209922768\n\n>>>> Estimator ParamMaps : \n{\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n}\n{\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n}\n{\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n}\n{\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n}\n{\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n}\n{\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n}\n{\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n}\n{\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n}\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_1893246303",
      "id": "20200523-032244_1150381937",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:470"
    },
    {
      "title": "Parameter  metric Score Mapping",
      "text": "val zippedParamAndMetrics = cvModel.getEstimatorParamMaps\n    .zip(cvModel.avgMetrics)\n    .sortBy(_._2)\n\nprintln(\"\\n>>>> Zipped Param And Metrics : \\n\" + zippedParamAndMetrics.mkString(\"\\n\"))\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:22:58+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\n>>>> Zipped Param And Metrics : \n({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.3955658514239)\n({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.39560910640768)\n({\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.39925209922768)\n({\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.3995357710174)\n({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.39991730841524)\n({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.39992432078058)\n({\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.40029509456177)\n({\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.4003022511408)\n\u001b[1m\u001b[34mzippedParamAndMetrics\u001b[0m: \u001b[1m\u001b[32mArray[(org.apache.spark.ml.param.ParamMap, Double)]\u001b[0m =\nArray(({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.3955658514239), ({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.39560910640768), ({\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.39925209922768), ({\n\tals_d3c63750e5fa-alpha: 1.0,\n\tals_d3c63750e5fa-rank: 3,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.3995357710174), ({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 0.01\n},86.39991730841524), ({\n\tals_d3c63750e5fa-alpha: 40.0,\n\tals_d3c63750e5fa-rank: 2,\n\tals_d3c63750e5fa-regParam: 1.0\n},86.39992432078058),...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_612527620",
      "id": "20200523-033545_1990415944",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:471"
    },
    {
      "title": "Model Evaluate (RMSE) ver.2",
      "text": "val predictionsDF2 = cvModel.transform(testDS)\npredictionsDF2.show()\n\nval rmse2 = regEval.evaluate(predictionsDF2)\nprintln(rmse2)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:23:20+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "playcount": "string",
                      "prediction": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------+--------+---------+--------------+\n| userid|artistid|playcount|    prediction|\n+-------+--------+---------+--------------+\n|1048223|     829|       22|  -0.027887257|\n|1048223| 1009819|        1|  0.0014414389|\n|1048446| 1004306|       44|   -0.07296537|\n|1048446| 1246195|        1|  -0.008102767|\n|2039136| 1027610|        6|  4.9178756E-4|\n|2416427| 1003178|        1|-1.5379531E-10|\n|1039100| 1234421|        2| -3.3136945E-5|\n|2046012| 1003000|        6|    0.46594593|\n|2055214| 1132517|        4| 4.4210656E-15|\n|2109450| 1300816|        3|  0.0049396195|\n|2013146| 1017688|        8|   -0.08437531|\n|2066265|     689|       76|  -0.004662388|\n|2399599| 1004416|        1|  -7.346865E-4|\n|2024175| 1001473|        2|  -2.163966E-6|\n|2026693| 1009232|        1|   -0.27033928|\n|2197781|    3123|        3| -0.0061775036|\n|2197781| 1000210|        3|   -0.21704328|\n|2197781| 1037970|        7|    0.26209307|\n|2431650|    5606|        1|    0.21492723|\n|2013446| 1008780|        6|    0.07407935|\n+-------+--------+---------+--------------+\nonly showing top 20 rows\n\n69.92106568200613\n\u001b[1m\u001b[34mpredictionsDF2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 2 more fields]\n\u001b[1m\u001b[34mrmse2\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 69.92106568200613\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_973830499",
      "id": "paragraph_1622846032240_23516738",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:472"
    },
    {
      "title": "CrossValidator Model HDFS Save",
      "text": "cvModel\n    .write\n    .overwrite\n    .save(\"hdfs://yms060-spark:9000/sungjin/model/audio/profiledata_06-May-2005/als_crossvalidator\")\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:26:20+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_1295622067",
      "id": "20200523-033717_729491511",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:473"
    },
    {
      "title": "Best ALS Model & HDFS Save",
      "text": "import org.apache.spark.ml.recommendation._\n\nprintln(\"\\n>>>> CrossValidatorModel : \\n\" + cvModel)\nprintln(\"\\n>>>> CrossValidatorModel.bestModel : \\n\" + cvModel.bestModel)\n\nval pipelineBestModel = cvModel.bestModel.asInstanceOf[PipelineModel]\n\nprintln(\"\\n>>>> PipelineModel.stages(0) : \\n\" + pipelineBestModel.stages(0))\n\nval alsBestModel = pipelineBestModel.stages(0).asInstanceOf[ALSModel]\n\nalsBestModel\n    .write\n    .overwrite\n    .save(\"hdfs://yms060-spark:9000/sungjin/model/audio/profiledata_06-May-2005/als\")\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:26:51+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\n>>>> CrossValidatorModel : \nCrossValidatorModel: uid=cv_e6e4c5d3af4f, bestModel=pipeline_3a1f9bf2db56, numFolds=2\n\n>>>> CrossValidatorModel.bestModel : \npipeline_3a1f9bf2db56\n\n>>>> PipelineModel.stages(0) : \nALSModel: uid=als_d3c63750e5fa, rank=3\nimport org.apache.spark.ml.recommendation._\n\u001b[1m\u001b[34mpipelineBestModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m = pipeline_3a1f9bf2db56\n\u001b[1m\u001b[34malsBestModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALSModel\u001b[0m = ALSModel: uid=als_d3c63750e5fa, rank=3\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_920033294",
      "id": "20200523-033837_903108720",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:474"
    },
    {
      "title": "HDFS data loading ",
      "text": "val loadedBestALSModel = ALSModel.load(\"hdfs://yms060-spark:9000/sungjin/model/audio/profiledata_06-May-2005/als\")\n\nprintln(\"\\n>>>> model.extractParamMap : \\n\" + loadedBestALSModel.extractParamMap)\nprintln(\"\\n>>>> model.explainParams : \\n\" + loadedBestALSModel.explainParams)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:28:00+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\n>>>> model.extractParamMap : \n{\n\tals_d3c63750e5fa-blockSize: 4096,\n\tals_d3c63750e5fa-coldStartStrategy: drop,\n\tals_d3c63750e5fa-itemCol: artistid,\n\tals_d3c63750e5fa-predictionCol: prediction,\n\tals_d3c63750e5fa-userCol: userid\n}\n\n>>>> model.explainParams : \nblockSize: block size for stacking input data in matrices. Data is stacked within partitions. If block size is more than remaining data in a partition then it is adjusted to the size of this data. (default: 4096, current: 4096)\ncoldStartStrategy: strategy for dealing with unknown or new users/items at prediction time. This may be useful in cross-validation or production scenarios, for handling user/item ids the model has not seen in the training data. Supported values: nan,drop. (default: nan, current: drop)\nitemCol: column name for item ids. Ids must be within the integer value range. (default: item, current: artistid)\npredictionCol: prediction column name (default: prediction)\nuserCol: column name for user ids. Ids must be within the integer value range. (default: user, current: userid)\n\u001b[1m\u001b[34mloadedBestALSModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.recommendation.ALSModel\u001b[0m = ALSModel: uid=als_d3c63750e5fa, rank=3\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_1185345931",
      "id": "20200523-033835_1972019719",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:475"
    },
    {
      "title": "ALSModel.recommendForUserSubset",
      "text": "val userDS2 = Seq(1001440, 2010008, 987654321)\n    .toDF(\"userID\")\n    .as[Int]\n\nuserDS2.printSchema\nuserDS2.show(false)\n\nval recommendedForSomeUsersDF2 = loadedBestALSModel.recommendForUserSubset(userDS2, 5)\nrecommendedForSomeUsersDF2.printSchema\nrecommendedForSomeUsersDF2.show(false)\nz.show(recommendedForSomeUsersDF2)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:28:32+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "recommendations": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userID: integer (nullable = false)\n\n+---------+\n|userID   |\n+---------+\n|1001440  |\n|2010008  |\n|987654321|\n+---------+\n\nroot\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n\n+-------+---------------------------------------------------------------------------------------------------------+\n|userid |recommendations                                                                                          |\n+-------+---------------------------------------------------------------------------------------------------------+\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |\n+-------+---------------------------------------------------------------------------------------------------------+\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\trecommendations\n2010008\tWrappedArray([1001588,2.92935], [1105902,2.5050955], [5810,2.1159916], [1000481,2.0772407], [1254198,1.8340149])\n1001440\tWrappedArray([1394,2.211307], [1259,2.2061815], [1001646,2.201697], [1000123,2.1893556], [1001531,2.1663435])\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserDS2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[Int]\u001b[0m = [userID: int]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022232_244746122",
      "id": "20200523-033834_2094734826",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:476"
    },
    {
      "title": "",
      "text": "val userDS2 = Seq(1001440, 2010008, 987654321)\n    .toDF(\"userID\")\n    .as[Int] \n\nuserDS2.printSchema\nuserDS2.show(false)\n\nval recommendedForSomeUsersDF2 = loadedBestALSModel.recommendForUserSubset(userDS2, 5)\nrecommendedForSomeUsersDF2.printSchema\nrecommendedForSomeUsersDF2.show(false)\n\nval recommendedForSomeUsersDF22 = recommendedForSomeUsersDF2\n    .withColumn(\"recommend\", explode($\"recommendations\"))\n    .withColumn(\"artistid\", $\"recommend.artistid\")\n    .withColumn(\"rating\", $\"recommend.rating\")\n\nrecommendedForSomeUsersDF22.printSchema()\nrecommendedForSomeUsersDF22.show(false)\nprintln(recommendedForSomeUsersDF22.count())\n\nval recommendedForSomeUsersDF33 = recommendedForSomeUsersDF22\n    .drop(\"recommendations\", \"recommend\")\n\nrecommendedForSomeUsersDF33.printSchema()\nrecommendedForSomeUsersDF33.show(false)\nprintln(recommendedForSomeUsersDF33.count())\n\nval recommendedForSomeUsersDF44 = recommendedForSomeUsersDF33.as(\"reco\")\n    .join(artistFinal.as(\"art\"), $\"reco.artistid\" === $\"art.artistid\")\n    .orderBy($\"userid\".asc, $\"rating\".desc)\n\nrecommendedForSomeUsersDF44.show(false)\nz.show(recommendedForSomeUsersDF44)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:28:53+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": false,
        "results": {
          "1": {
            "graph": {
              "mode": "table",
              "height": 300,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "userid": "string",
                      "artistid": "string",
                      "rating": "string",
                      "artistname": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userID: integer (nullable = false)\n\n+---------+\n|userID   |\n+---------+\n|1001440  |\n|2010008  |\n|987654321|\n+---------+\n\nroot\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n\n+-------+---------------------------------------------------------------------------------------------------------+\n|userid |recommendations                                                                                          |\n+-------+---------------------------------------------------------------------------------------------------------+\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|\n+-------+---------------------------------------------------------------------------------------------------------+\n\nroot\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n |-- recommend: struct (nullable = true)\n |    |-- artistid: integer (nullable = true)\n |    |-- rating: float (nullable = true)\n |-- artistid: integer (nullable = true)\n |-- rating: float (nullable = true)\n\n+-------+---------------------------------------------------------------------------------------------------------+--------------------+--------+---------+\n|userid |recommendations                                                                                          |recommend           |artistid|rating   |\n+-------+---------------------------------------------------------------------------------------------------------+--------------------+--------+---------+\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |{1394, 2.211307}    |1394    |2.211307 |\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |{1259, 2.2061815}   |1259    |2.2061815|\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |{1001646, 2.201697} |1001646 |2.201697 |\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |{1000123, 2.1893556}|1000123 |2.1893556|\n|1001440|[{1394, 2.211307}, {1259, 2.2061815}, {1001646, 2.201697}, {1000123, 2.1893556}, {1001531, 2.1663435}]   |{1001531, 2.1663435}|1001531 |2.1663435|\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|{1001588, 2.92935}  |1001588 |2.92935  |\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|{1105902, 2.5050955}|1105902 |2.5050955|\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|{5810, 2.1159916}   |5810    |2.1159916|\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|{1000481, 2.0772407}|1000481 |2.0772407|\n|2010008|[{1001588, 2.92935}, {1105902, 2.5050955}, {5810, 2.1159916}, {1000481, 2.0772407}, {1254198, 1.8340149}]|{1254198, 1.8340149}|1254198 |1.8340149|\n+-------+---------------------------------------------------------------------------------------------------------+--------------------+--------+---------+\n\n10\nroot\n |-- userid: integer (nullable = false)\n |-- artistid: integer (nullable = true)\n |-- rating: float (nullable = true)\n\n+-------+--------+---------+\n|userid |artistid|rating   |\n+-------+--------+---------+\n|2010008|1001588 |2.92935  |\n|2010008|1105902 |2.5050955|\n|2010008|5810    |2.1159916|\n|2010008|1000481 |2.0772407|\n|2010008|1254198 |1.8340149|\n|1001440|1394    |2.211307 |\n|1001440|1259    |2.2061815|\n|1001440|1001646 |2.201697 |\n|1001440|1000123 |2.1893556|\n|1001440|1001531 |2.1663435|\n+-------+--------+---------+\n\n10\n+-------+--------+---------+--------+---------------------+\n|userid |artistid|rating   |artistid|artistname           |\n+-------+--------+---------+--------+---------------------+\n|1001440|1394    |2.211307 |1394    |Led Zeppelin         |\n|1001440|1259    |2.2061815|1259    |Oasis                |\n|1001440|1001646 |2.201697 |1001646 |The Smashing Pumpkins|\n|1001440|1000123 |2.1893556|1000123 |Incubus              |\n|1001440|1001531 |2.1663435|1001531 |Belle and Sebastian  |\n|2010008|1001588 |2.92935  |1001588 |Morrissey            |\n|2010008|1105902 |2.5050955|1105902 |M83                  |\n|2010008|5810    |2.1159916|5810    |The Prodigy          |\n|2010008|1000481 |2.0772407|1000481 |Slipknot             |\n|2010008|1254198 |1.8340149|1254198 |The Dresden Dolls    |\n+-------+--------+---------+--------+---------------------+\n\n"
          },
          {
            "type": "TABLE",
            "data": "userid\tartistid\trating\tartistid\tartistname\n1001440\t1394\t2.211307\t1394\tLed Zeppelin\n1001440\t1259\t2.2061815\t1259\tOasis\n1001440\t1001646\t2.201697\t1001646\tThe Smashing Pumpkins\n1001440\t1000123\t2.1893556\t1000123\tIncubus\n1001440\t1001531\t2.1663435\t1001531\tBelle and Sebastian\n2010008\t1001588\t2.92935\t1001588\tMorrissey\n2010008\t1105902\t2.5050955\t1105902\tM83\n2010008\t5810\t2.1159916\t5810\tThe Prodigy\n2010008\t1000481\t2.0772407\t1000481\tSlipknot\n2010008\t1254198\t1.8340149\t1254198\tThe Dresden Dolls\n"
          },
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34muserDS2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[Int]\u001b[0m = [userID: int]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>>]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF22\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>> ... 3 more fields]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF33\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid: int ... 1 more field]\n\u001b[1m\u001b[34mrecommendedForSomeUsersDF44\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [userid: int, artistid: int ... 3 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022233_9795078",
      "id": "20200818-093435_779849078",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:477"
    },
    {
      "title": "Redis",
      "text": "val recommendedForAllUsersDF = loadedBestALSModel.recommendForAllUsers(5)\n\nrecommendedForAllUsersDF.printSchema\nrecommendedForAllUsersDF.show(false)\nprintln(recommendedForAllUsersDF.count)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:29:00+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n\n+------+-------------------------------------------------------------------------------------------------------------------------------+\n|userid|recommendations                                                                                                                |\n+------+-------------------------------------------------------------------------------------------------------------------------------+\n|321   |[{3619, 1.9876902}, {1274, 1.9325128}, {831, 1.9117409}, {1275996, 1.8158251}, {1991, 1.6743395}]                              |\n|581   |[{3619, 1.0734386}, {1274, 1.0608234}, {1270, 0.93612045}, {1002287, 0.93071556}, {441, 0.92958516}]                           |\n|727   |[{1270639, 1.4911687E-13}, {1307, 1.4383156E-13}, {3619, 1.4243547E-13}, {1250233, 1.370253E-13}, {1001277, 1.3369733E-13}]    |\n|770   |[{1007286, 0.0017694583}, {831, 0.0017210621}, {1001419, 0.0013265773}, {352, 0.0013190034}, {1000009, 0.0013130265}]          |\n|1197  |[{979, 0.048101965}, {1001588, 0.044500954}, {121, 0.040261045}, {1233770, 0.03984686}, {4267, 0.039662864}]                   |\n|2686  |[{831, 0.004667971}, {1274, 0.004628415}, {1275996, 0.0039887037}, {189, 0.003837312}, {1991, 0.0037610938}]                   |\n|3208  |[{1001419, 1.4418816E-15}, {1007286, 1.4334396E-15}, {1001779, 1.2440862E-15}, {4481, 1.2089971E-15}, {4496, 1.1988092E-15}]   |\n|3793  |[{1002734, 0.0013607014}, {1394, 0.0013254072}, {1001646, 0.0012054476}, {831, 0.0012043924}, {1205, 0.0011892023}]            |\n|5069  |[{1002734, 0.5397922}, {1394, 0.49756503}, {1205, 0.47371623}, {1854, 0.44166076}, {1034635, 0.43926138}]                      |\n|5868  |[{1274, 1.4903008E-15}, {3619, 1.3203223E-15}, {1275996, 1.2191172E-15}, {1231740, 1.187549E-15}, {1007903, 1.1470857E-15}]    |\n|6043  |[{979, 0.47311714}, {3619, 0.44267523}, {1270, 0.3988404}, {1233770, 0.39497986}, {121, 0.3848268}]                            |\n|6060  |[{979, 6.519824E-4}, {3619, 5.941739E-4}, {1001588, 5.934793E-4}, {121, 5.675506E-4}, {930, 5.6538556E-4}]                     |\n|6116  |[{979, 0.60742116}, {1233770, 0.46600652}, {1000062, 0.45521152}, {1270, 0.44004402}, {1008419, 0.43080622}]                   |\n|6141  |[{1394, 9.459085E-11}, {1002734, 9.0004E-11}, {1001646, 8.876676E-11}, {1274, 8.680685E-11}, {1205, 8.3227654E-11}]            |\n|6365  |[{1001588, 1.9009224E-15}, {1105902, 1.4969432E-15}, {5810, 1.3006907E-15}, {1000481, 1.2481144E-15}, {1048991, 1.1665701E-15}]|\n|6676  |[{1233239, 1.1096058}, {1014536, 0.9981395}, {1000263, 0.9625226}, {463, 0.9323232}, {754, 0.898315}]                          |\n|6718  |[{1233196, 1.665786E-15}, {1233239, 1.4474489E-15}, {3327, 1.4285054E-15}, {4192, 1.2135236E-15}, {1890, 1.1958389E-15}]       |\n|6865  |[{1001588, 6.396525E-4}, {3619, 5.2061386E-4}, {930, 5.157453E-4}, {1270639, 4.9020606E-4}, {1001007, 4.6749032E-4}]           |\n|6937  |[{1000123, 0.7520151}, {1259, 0.68721783}, {1001531, 0.6730344}, {1001646, 0.66793346}, {1231740, 0.6587136}]                  |\n|6961  |[{831, 0.0066750105}, {1274, 0.0061214333}, {1275996, 0.0056979405}, {3619, 0.0056559257}, {189, 0.005318078}]                 |\n+------+-------------------------------------------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n40705\n\u001b[1m\u001b[34mrecommendedForAllUsersDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022233_395343147",
      "id": "paragraph_1608693931794_1958815898",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:478"
    },
    {
      "title": "5 Artist Recommendations for All Users",
      "text": "val recommendedForAllUsersDF2 = recommendedForAllUsersDF\n    .withColumn(\"recommendation\", explode($\"recommendations\"))\n    .withColumn(\"artistid\", $\"recommendation.artistid\")\n    \nrecommendedForAllUsersDF2.printSchema\nrecommendedForAllUsersDF2.show(false)\nprintln(recommendedForAllUsersDF2.count)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:29:14+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- recommendations: array (nullable = true)\n |    |-- element: struct (containsNull = true)\n |    |    |-- artistid: integer (nullable = true)\n |    |    |-- rating: float (nullable = true)\n |-- recommendation: struct (nullable = true)\n |    |-- artistid: integer (nullable = true)\n |    |-- rating: float (nullable = true)\n |-- artistid: integer (nullable = true)\n\n+------+---------------------------------------------------------------------------------------------------------------------------+------------------------+--------+\n|userid|recommendations                                                                                                            |recommendation          |artistid|\n+------+---------------------------------------------------------------------------------------------------------------------------+------------------------+--------+\n|321   |[{3619, 1.9876902}, {1274, 1.9325128}, {831, 1.9117409}, {1275996, 1.8158251}, {1991, 1.6743395}]                          |{3619, 1.9876902}       |3619    |\n|321   |[{3619, 1.9876902}, {1274, 1.9325128}, {831, 1.9117409}, {1275996, 1.8158251}, {1991, 1.6743395}]                          |{1274, 1.9325128}       |1274    |\n|321   |[{3619, 1.9876902}, {1274, 1.9325128}, {831, 1.9117409}, {1275996, 1.8158251}, {1991, 1.6743395}]                          |{831, 1.9117409}        |831     |\n|321   |[{3619, 1.9876902}, {1274, 1.9325128}, {831, 1.9117409}, {1275996, 1.8158251}, {1991, 1.6743395}]                          |{1275996, 1.8158251}    |1275996 |\n|321   |[{3619, 1.9876902}, {1274, 1.9325128}, {831, 1.9117409}, {1275996, 1.8158251}, {1991, 1.6743395}]                          |{1991, 1.6743395}       |1991    |\n|581   |[{3619, 1.0734386}, {1274, 1.0608234}, {1270, 0.93612045}, {1002287, 0.93071556}, {441, 0.92958516}]                       |{3619, 1.0734386}       |3619    |\n|581   |[{3619, 1.0734386}, {1274, 1.0608234}, {1270, 0.93612045}, {1002287, 0.93071556}, {441, 0.92958516}]                       |{1274, 1.0608234}       |1274    |\n|581   |[{3619, 1.0734386}, {1274, 1.0608234}, {1270, 0.93612045}, {1002287, 0.93071556}, {441, 0.92958516}]                       |{1270, 0.93612045}      |1270    |\n|581   |[{3619, 1.0734386}, {1274, 1.0608234}, {1270, 0.93612045}, {1002287, 0.93071556}, {441, 0.92958516}]                       |{1002287, 0.93071556}   |1002287 |\n|581   |[{3619, 1.0734386}, {1274, 1.0608234}, {1270, 0.93612045}, {1002287, 0.93071556}, {441, 0.92958516}]                       |{441, 0.92958516}       |441     |\n|727   |[{1270639, 1.4911687E-13}, {1307, 1.4383156E-13}, {3619, 1.4243547E-13}, {1250233, 1.370253E-13}, {1001277, 1.3369733E-13}]|{1270639, 1.4911687E-13}|1270639 |\n|727   |[{1270639, 1.4911687E-13}, {1307, 1.4383156E-13}, {3619, 1.4243547E-13}, {1250233, 1.370253E-13}, {1001277, 1.3369733E-13}]|{1307, 1.4383156E-13}   |1307    |\n|727   |[{1270639, 1.4911687E-13}, {1307, 1.4383156E-13}, {3619, 1.4243547E-13}, {1250233, 1.370253E-13}, {1001277, 1.3369733E-13}]|{3619, 1.4243547E-13}   |3619    |\n|727   |[{1270639, 1.4911687E-13}, {1307, 1.4383156E-13}, {3619, 1.4243547E-13}, {1250233, 1.370253E-13}, {1001277, 1.3369733E-13}]|{1250233, 1.370253E-13} |1250233 |\n|727   |[{1270639, 1.4911687E-13}, {1307, 1.4383156E-13}, {3619, 1.4243547E-13}, {1250233, 1.370253E-13}, {1001277, 1.3369733E-13}]|{1001277, 1.3369733E-13}|1001277 |\n|770   |[{1007286, 0.0017694583}, {831, 0.0017210621}, {1001419, 0.0013265773}, {352, 0.0013190034}, {1000009, 0.0013130265}]      |{1007286, 0.0017694583} |1007286 |\n|770   |[{1007286, 0.0017694583}, {831, 0.0017210621}, {1001419, 0.0013265773}, {352, 0.0013190034}, {1000009, 0.0013130265}]      |{831, 0.0017210621}     |831     |\n|770   |[{1007286, 0.0017694583}, {831, 0.0017210621}, {1001419, 0.0013265773}, {352, 0.0013190034}, {1000009, 0.0013130265}]      |{1001419, 0.0013265773} |1001419 |\n|770   |[{1007286, 0.0017694583}, {831, 0.0017210621}, {1001419, 0.0013265773}, {352, 0.0013190034}, {1000009, 0.0013130265}]      |{352, 0.0013190034}     |352     |\n|770   |[{1007286, 0.0017694583}, {831, 0.0017210621}, {1001419, 0.0013265773}, {352, 0.0013190034}, {1000009, 0.0013130265}]      |{1000009, 0.0013130265} |1000009 |\n+------+---------------------------------------------------------------------------------------------------------------------------+------------------------+--------+\nonly showing top 20 rows\n\n203525\n\u001b[1m\u001b[34mrecommendedForAllUsersDF2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommendations: array<struct<artistid:int,rating:float>> ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022233_2101202548",
      "id": "paragraph_1659541000725_2038207781",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:479"
    },
    {
      "title": "",
      "text": "val recommendedForAllUsersDF3 = recommendedForAllUsersDF2\n    .groupBy(\"userid\")\n    .agg(collect_list(\"artistid\").as(\"artistid_list\"))\n    .withColumn(\"recommended_artistids\", array_join(col(\"artistid_list\"), \" \"))\n    \nrecommendedForAllUsersDF3.printSchema\nrecommendedForAllUsersDF3.show(false)\nprintln(recommendedForAllUsersDF3.count)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:29:19+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- artistid_list: array (nullable = false)\n |    |-- element: integer (containsNull = false)\n |-- recommended_artistids: string (nullable = false)\n\n+------+------------------------------------------+------------------------------------+\n|userid|artistid_list                             |recommended_artistids               |\n+------+------------------------------------------+------------------------------------+\n|321   |[3619, 1274, 831, 1275996, 1991]          |3619 1274 831 1275996 1991          |\n|581   |[3619, 1274, 1270, 1002287, 441]          |3619 1274 1270 1002287 441          |\n|727   |[1270639, 1307, 3619, 1250233, 1001277]   |1270639 1307 3619 1250233 1001277   |\n|770   |[1007286, 831, 1001419, 352, 1000009]     |1007286 831 1001419 352 1000009     |\n|1197  |[979, 1001588, 121, 1233770, 4267]        |979 1001588 121 1233770 4267        |\n|2686  |[831, 1274, 1275996, 189, 1991]           |831 1274 1275996 189 1991           |\n|3208  |[1001419, 1007286, 1001779, 4481, 4496]   |1001419 1007286 1001779 4481 4496   |\n|3793  |[1002734, 1394, 1001646, 831, 1205]       |1002734 1394 1001646 831 1205       |\n|5069  |[1002734, 1394, 1205, 1854, 1034635]      |1002734 1394 1205 1854 1034635      |\n|5868  |[1274, 3619, 1275996, 1231740, 1007903]   |1274 3619 1275996 1231740 1007903   |\n|6043  |[979, 3619, 1270, 1233770, 121]           |979 3619 1270 1233770 121           |\n|6060  |[979, 3619, 1001588, 121, 930]            |979 3619 1001588 121 930            |\n|6116  |[979, 1233770, 1000062, 1270, 1008419]    |979 1233770 1000062 1270 1008419    |\n|6141  |[1394, 1002734, 1001646, 1274, 1205]      |1394 1002734 1001646 1274 1205      |\n|6365  |[1001588, 1105902, 5810, 1000481, 1048991]|1001588 1105902 5810 1000481 1048991|\n|6676  |[1233239, 1014536, 1000263, 463, 754]     |1233239 1014536 1000263 463 754     |\n|6718  |[1233196, 1233239, 3327, 4192, 1890]      |1233196 1233239 3327 4192 1890      |\n|6865  |[1001588, 3619, 930, 1270639, 1001007]    |1001588 3619 930 1270639 1001007    |\n|6937  |[1000123, 1259, 1001531, 1001646, 1231740]|1000123 1259 1001531 1001646 1231740|\n|6961  |[831, 1274, 1275996, 3619, 189]           |831 1274 1275996 3619 189           |\n+------+------------------------------------------+------------------------------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mrecommendedForAllUsersDF3\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, artistid_list: array<int> ... 1 more field]\n\u001b[1m\u001b[34mres170\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 40705\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022233_5971499",
      "id": "paragraph_1659575090362_1024723788",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:480"
    },
    {
      "title": "",
      "text": "val recommendedForAllUsersDF4 = recommendedForAllUsersDF3.select($\"userid\", $\"recommended_artistids\")\nrecommendedForAllUsersDF4.printSchema\nrecommendedForAllUsersDF4.show(false)\nprintln(recommendedForAllUsersDF4.count)\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:29:23+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- recommended_artistids: string (nullable = false)\n\n+------+------------------------------------+\n|userid|recommended_artistids               |\n+------+------------------------------------+\n|321   |3619 1274 831 1275996 1991          |\n|581   |3619 1274 1270 1002287 441          |\n|727   |1270639 1307 3619 1250233 1001277   |\n|770   |1007286 831 1001419 352 1000009     |\n|1197  |979 1001588 121 1233770 4267        |\n|2686  |831 1274 1275996 189 1991           |\n|3208  |1001419 1007286 1001779 4481 4496   |\n|3793  |1002734 1394 1001646 831 1205       |\n|5069  |1002734 1394 1205 1854 1034635      |\n|5868  |1274 3619 1275996 1231740 1007903   |\n|6043  |979 3619 1270 1233770 121           |\n|6060  |979 3619 1001588 121 930            |\n|6116  |979 1233770 1000062 1270 1008419    |\n|6141  |1394 1002734 1001646 1274 1205      |\n|6365  |1001588 1105902 5810 1000481 1048991|\n|6676  |1233239 1014536 1000263 463 754     |\n|6718  |1233196 1233239 3327 4192 1890      |\n|6865  |1001588 3619 930 1270639 1001007    |\n|6937  |1000123 1259 1001531 1001646 1231740|\n|6961  |831 1274 1275996 3619 189           |\n+------+------------------------------------+\nonly showing top 20 rows\n\n40705\n\u001b[1m\u001b[34mrecommendedForAllUsersDF4\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommended_artistids: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022233_1129762940",
      "id": "paragraph_1659575709710_351568299",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:481"
    },
    {
      "title": "Redis에 추천 데이터 저장",
      "text": "recommendedForAllUsersDF4\n    .write\n    .format(\"org.apache.spark.sql.redis\")\n    .option(\"table\", \"user_artists\")\n    .option(\"key.column\", \"userid\")\n    .mode(\"append\")\n    .save()\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:29:47+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022234_2109758258",
      "id": "paragraph_1659540097176_332400557",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:482"
    },
    {
      "title": "",
      "text": "val recommendedForAllUsersDF5 = spark\r\n    .read\r\n    .format(\"org.apache.spark.sql.redis\")\r\n    .option(\"table\", \"user_artists\")\r\n    .option(\"key.column\", \"userid\")\r\n    .load()\r\n\r\nrecommendedForAllUsersDF5.printSchema\r\nrecommendedForAllUsersDF5.show(false)\r\nprintln(recommendedForAllUsersDF5.count)\r\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:30:10+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "title": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- userid: integer (nullable = false)\n |-- recommended_artistids: string (nullable = false)\n\n+-------+-----------------------------------+\n|userid |recommended_artistids              |\n+-------+-----------------------------------+\n|2127894|1001588 4267 979 121 1048991       |\n|2403740|4192 3327 1259 1003968 1394        |\n|2367561|979 1001588 1233770 4267 121       |\n|1031899|4481 976 1233196 1000952 1006234   |\n|1031898|1001419 718 1000031 1000323 1105902|\n|2102592|979 1001588 3619 121 930           |\n|2176825|441 1231740 1002287 1000123 1274   |\n|2137217|1274 3619 1275996 1991 1025225     |\n|2379546|1007286 1001419 831 352 1000031    |\n|2355582|1233239 1233196 1890 234 3327      |\n|2415723|1274 1001646 1394 1004536 1231740  |\n|2354245|1001588 1000263 1000429 754 1014536|\n|2378216|4481 1001779 1187 1026440 1004305  |\n|2113244|1001588 4267 1048991 2003588 930   |\n|2137213|979 3619 1270 1233770 121          |\n|2392518|1274 1001646 1394 1004536 1231740  |\n|2114570|3619 1001588 930 979 1000033       |\n|1067851|1233196 1233239 3327 234 1890      |\n|2164847|979 3619 1233770 121 1270          |\n|2163515|831 1270639 1004294 1307 1007735   |\n+-------+-----------------------------------+\nonly showing top 20 rows\n\n40705\n\u001b[1m\u001b[34mrecommendedForAllUsersDF5\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [userid: int, recommended_artistids: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022234_715776233",
      "id": "paragraph_1659538145596_1304043836",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:483"
    },
    {
      "title": "Redis 사용자를 위한 5건 추천 조회",
      "text": "val recommendedForAllUsersDF4 = spark\r\n    .read\r\n    .format(\"org.apache.spark.sql.redis\")\r\n    .option(\"keys.pattern\", \"user_artists:2127894\")\r\n    .option(\"key.column\", \"userid\")\r\n    .option(\"infer.schema\", true)\r\n    .load()\r\n\r\nrecommendedForAllUsersDF4.printSchema\r\nrecommendedForAllUsersDF4.show(false)\r\n",
      "user": "anonymous",
      "dateUpdated": "2023-04-10T19:30:33+0900",
      "progress": 0,
      "config": {
        "lineNumbers": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "root\n |-- recommended_artistids: string (nullable = true)\n |-- userid: string (nullable = true)\n\n+----------------------------+--------------------+\n|recommended_artistids       |userid              |\n+----------------------------+--------------------+\n|1001588 4267 979 121 1048991|user_artists:2127894|\n+----------------------------+--------------------+\n\n\u001b[1m\u001b[34mrecommendedForAllUsersDF4\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [recommended_artistids: string, userid: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1680506022234_1816289605",
      "id": "paragraph_1659538200460_2142292108",
      "dateCreated": "2023-04-03T16:13:42+0900",
      "status": "READY",
      "$$hashKey": "object:484"
    }
  ],
  "name": "by ALS",
  "id": "2HWVJ6T6V",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {},
  "path": "/by ALS"
}